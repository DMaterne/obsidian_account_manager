/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => AuthentificatorPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var import_crypto = require("crypto");
var import_obsidian2 = require("obsidian");
var USERS_PATH = "DnDAuth/users.json";
var DEFAULT_STATE = {
  currentCharacter: null,
  isAuthenticated: false,
  currentGroups: []
};
function sha256Base64(text) {
  return (0, import_crypto.createHash)("sha256").update(text, "utf8").digest("base64");
}
function makeSalt(bytes = 16) {
  return (0, import_crypto.randomBytes)(bytes).toString("base64");
}
function addActionButton(parent, label, action) {
  const btn = parent.createEl("button", { text: label });
  btn.style.marginRight = "0.5rem";
  btn.addEventListener("click", action);
}
function parseDndGate(source) {
  const lines = source.split("\n");
  let groups = [];
  let requireAuth = true;
  let startBodyAt = 0;
  for (let i = 0; i < lines.length; i++) {
    const line = lines[i].trim();
    if (line === "---") {
      startBodyAt = i + 1;
      break;
    }
    if (!line) continue;
    const mg = line.match(/^groups\s*:\s*(.+)$/i);
    if (mg) {
      groups = mg[1].split(",").map((s) => s.trim()).filter(Boolean);
      continue;
    }
    const ma = line.match(/^requireAuth\s*:\s*(true|false)$/i);
    if (ma) {
      requireAuth = ma[1].toLowerCase() === "true";
      continue;
    }
  }
  const body = lines.slice(startBodyAt).join("\n");
  return { groups, body, requireAuth };
}
var AuthentificatorPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.state = { ...DEFAULT_STATE };
    this.statusEl = null;
  }
  async onload() {
    this.state = { ...DEFAULT_STATE, ...await this.loadData() };
    await this.ensureUsersFile();
    this.statusEl = this.addStatusBarItem();
    this.renderStatus();
    if (this.statusEl) {
      this.statusEl.style.cursor = "pointer";
      this.statusEl.addEventListener("click", () => {
        new StatusMenuModal(this.app, this).open();
      });
    }
    this.registerMarkdownCodeBlockProcessor("dndadmin", async (source, el) => {
      var _a;
      if (!this.isAdmin()) {
        el.createEl("div", { text: "\u{1F512} Admin only." });
        return;
      }
      const row = el.createDiv();
      const createBtn = row.createEl("button", { text: "Create / Update user" });
      createBtn.onclick = () => {
        this.app.commands.executeCommandById(
          "obsidian_account_manager:authentificator-admin-create-update-user"
        );
      };
      const reportBtn = row.createEl("button", { text: "Regenerate report" });
      reportBtn.style.marginLeft = "0.5rem";
      reportBtn.onclick = async () => {
        await this.generateUserReportNote();
        this.refreshAllMarkdownViews();
        new import_obsidian.Notice("\u2705 Report updated");
      };
      el.createEl("hr");
      const users = await this.loadUsers();
      for (const u of users) {
        el.createDiv({
          text: `${u.name} \u2014 ${((_a = u.groups) != null ? _a : []).join(", ") || "-"}`
        });
      }
    });
    this.addCommand({
      id: "authentificator-admin-setup-admin-area",
      name: "Admin: Setup Admin Area",
      callback: async () => {
        if (!this.isAdmin()) {
          new import_obsidian.Notice("\u{1F6AB} Admin only. Please login as Admin.");
          return;
        }
        await this.ensureFolder("Admin Area");
        await this.upsertFile(
          "Admin Area/UserManagement.md",
          [
            "---",
            "dnd_access_groups: [admin]",
            "dnd_require_auth: true",
            "generated: true",
            "---",
            "",
            "# Admin Area \u2013 User Management",
            "",
            "```dndadmin",
            "mode: users",
            "```",
            ""
          ].join("\n")
        );
        await this.generateUserReportNote();
        this.refreshAllMarkdownViews();
        const f = this.app.vault.getAbstractFileByPath("Admin Area/UserManagement.md");
        if (f) await this.app.workspace.getLeaf(true).openFile(f);
        new import_obsidian.Notice("\u2705 Admin Area created/updated.");
      }
    });
    this.addCommand({
      id: "authentificator-select-character",
      name: "Select character",
      callback: async () => {
        const users = await this.loadUsers();
        const picked = await new Promise((resolve) => {
          new ButtonUserPickModal(this.app, users, resolve).open();
        });
        if (!picked) return;
        this.state.currentCharacter = picked.name;
        this.state.isAuthenticated = false;
        this.state.currentGroups = [];
        await this.saveData(this.state);
        this.renderStatus();
        this.refreshAllMarkdownViews();
        new import_obsidian.Notice(`Selected character: ${picked.name}`);
      }
    });
    this.addCommand({
      id: "authentificator-login",
      name: "Login (password)",
      callback: async () => {
        var _a;
        const user = this.state.currentCharacter;
        if (!user) {
          new import_obsidian.Notice("Select a character first.");
          return;
        }
        const password = await new Promise((resolve) => {
          new PasswordModal(this.app, resolve).open();
        });
        if (!password) return;
        const ok = await this.verifyPassword(user, password);
        if (!ok) {
          this.state.isAuthenticated = false;
          this.state.currentGroups = [];
          await this.saveData(this.state);
          this.renderStatus();
          this.refreshAllMarkdownViews();
          new import_obsidian.Notice("\u274C Login failed.");
          return;
        }
        const users = await this.loadUsers();
        const entry = users.find((u) => u.name === user);
        this.state.isAuthenticated = true;
        this.state.currentGroups = ((_a = entry == null ? void 0 : entry.groups) != null ? _a : []).map(String);
        await this.saveData(this.state);
        this.renderStatus();
        this.refreshAllMarkdownViews();
        new import_obsidian.Notice(`\u2705 Logged in as ${user}`);
      }
    });
    this.addCommand({
      id: "authentificator-logout",
      name: "Logout",
      callback: async () => {
        this.state = { ...DEFAULT_STATE };
        await this.saveData(this.state);
        this.renderStatus();
        this.refreshAllMarkdownViews();
        new import_obsidian.Notice("Logged out.");
      }
    });
    this.addCommand({
      id: "authentificator-open-gated-note",
      name: "Open gated note\u2026",
      callback: async () => {
        if (!this.isAdmin() && !this.state.isAuthenticated) {
          new import_obsidian.Notice("Please login first.");
          return;
        }
        new LiveFilePickModal(this.app, this).open();
      }
    });
    this.addCommand({
      id: "authentificator-admin-create-update-user",
      name: "Admin: Create/Update user",
      callback: async () => {
        if (!this.isAdmin()) {
          new import_obsidian.Notice("\u{1F6AB} Admin only. Please login as Admin.");
          return;
        }
        const result = await new Promise((resolve) => {
          new CreateUserModal(this.app, resolve).open();
        });
        if (!result) return;
        const name = result.name.trim();
        const password = result.password;
        if (!name) return void new import_obsidian.Notice("User name cannot be empty.");
        if (!password) return void new import_obsidian.Notice("Password cannot be empty.");
        let groups = result.groups.split(",").map((s) => s.trim()).filter(Boolean);
        if (name === "Admin" && !groups.includes("admin")) groups.push("admin");
        const users = await this.loadUsers();
        const salt = makeSalt();
        const hash = sha256Base64(`${salt}:${password}`);
        const idx = users.findIndex((u) => u.name === name);
        const entry = { name, salt, hash, groups };
        if (idx >= 0) users[idx] = entry;
        else users.push(entry);
        await this.saveUsers(users);
        this.refreshAllMarkdownViews();
        new import_obsidian.Notice(`\u2705 Saved user: ${name}`);
      }
    });
    this.addCommand({
      id: "authentificator-admin-toggle-group",
      name: "Admin: Toggle group for user",
      callback: async () => {
        var _a, _b;
        if (!this.isAdmin()) {
          new import_obsidian.Notice("\u{1F6AB} Admin only. Please login as Admin.");
          return;
        }
        const group = await new Promise((resolve) => {
          new SingleLineModal(
            this.app,
            "Toggle group",
            "Group name (e.g. session_07_reveal)",
            resolve
          ).open();
        });
        if (!group) return;
        const g = group.trim();
        const users = await this.loadUsers();
        const picked = await new Promise((resolve) => {
          new UserPickModal(
            this.app,
            users.filter((u) => u.name !== "Admin"),
            resolve
          ).open();
        });
        if (!picked) return;
        const idx = users.findIndex((u) => u.name === picked.name);
        if (idx < 0) return;
        const set = new Set(((_a = users[idx].groups) != null ? _a : []).map(String));
        let action;
        if (set.has(g)) {
          set.delete(g);
          action = "removed";
        } else {
          set.add(g);
          action = "added";
        }
        users[idx].groups = Array.from(set);
        await this.saveUsers(users);
        if (this.state.currentCharacter === users[idx].name && this.state.isAuthenticated) {
          this.state.currentGroups = (_b = users[idx].groups) != null ? _b : [];
          await this.saveData(this.state);
          this.renderStatus();
        }
        this.refreshAllMarkdownViews();
        new import_obsidian.Notice(
          `\u2705 ${action.toUpperCase()}: "${g}" ${action === "added" ? "to" : "from"} ${picked.name}`
        );
      }
    });
    this.addCommand({
      id: "authentificator-admin-toggle-group-all",
      name: "Admin: Toggle group for ALL players",
      callback: async () => {
        var _a;
        if (!this.isAdmin()) {
          new import_obsidian.Notice("\u{1F6AB} Admin only. Please login as Admin.");
          return;
        }
        const group = await new Promise((resolve) => {
          new SingleLineModal(
            this.app,
            "Toggle group for ALL",
            "Group name (e.g. session_07_reveal)",
            resolve
          ).open();
        });
        if (!group) return;
        const g = group.trim();
        const users = await this.loadUsers();
        const players = users.filter((u) => u.name !== "Admin");
        const countHas = players.filter((u) => {
          var _a2;
          return ((_a2 = u.groups) != null ? _a2 : []).includes(g);
        }).length;
        const shouldAdd = countHas < Math.ceil(players.length / 2);
        for (const u of players) {
          const set = new Set(((_a = u.groups) != null ? _a : []).map(String));
          if (shouldAdd) set.add(g);
          else set.delete(g);
          u.groups = Array.from(set);
        }
        await this.saveUsers(users);
        this.refreshAllMarkdownViews();
        new import_obsidian.Notice(
          `\u2705 ${shouldAdd ? "Added" : "Removed"} "${g}" ${shouldAdd ? "to" : "from"} ALL players`
        );
      }
    });
    this.addCommand({
      id: "authentificator-admin-reset-temp-groups",
      name: "Admin: Reset temporary groups",
      callback: async () => {
        var _a;
        if (!this.isAdmin()) {
          new import_obsidian.Notice("\u{1F6AB} Admin only. Please login as Admin.");
          return;
        }
        const prefix = await new Promise((resolve) => {
          new SingleLineModal(
            this.app,
            "Reset temporary groups",
            "Prefix (default: session_)",
            resolve
          ).open();
        });
        const p = prefix && prefix.trim().length > 0 ? prefix.trim() : "session_";
        const users = await this.loadUsers();
        for (const u of users) {
          if (u.name === "Admin") continue;
          u.groups = ((_a = u.groups) != null ? _a : []).filter((gr) => !String(gr).startsWith(p));
        }
        await this.saveUsers(users);
        this.refreshAllMarkdownViews();
        new import_obsidian.Notice(`\u2705 Removed all groups starting with "${p}" from all players`);
      }
    });
    this.addCommand({
      id: "authentificator-admin-who-has-group",
      name: "Admin: Who has group?",
      callback: async () => {
        if (!this.isAdmin()) {
          new import_obsidian.Notice("\u{1F6AB} Admin only. Please login as Admin.");
          return;
        }
        const group = await new Promise((resolve) => {
          new SingleLineModal(
            this.app,
            "Who has group?",
            "Group name (e.g. party)",
            resolve
          ).open();
        });
        if (!group) return;
        const g = group.trim();
        const users = await this.loadUsers();
        const holders = users.filter((u) => u.name !== "Admin").filter((u) => {
          var _a;
          return ((_a = u.groups) != null ? _a : []).includes(g);
        }).map((u) => u.name);
        new import_obsidian.Notice(
          holders.length ? `\u2705 "${g}" holders: ${holders.join(", ")}` : `\u2139\uFE0F Nobody has "${g}"`
        );
      }
    });
    this.registerMarkdownCodeBlockProcessor("dndgate", async (source, el, ctx) => {
      var _a;
      const parsed = parseDndGate(source);
      if (this.isAdmin()) {
        await import_obsidian2.MarkdownRenderer.renderMarkdown(parsed.body.trim(), el, ctx.sourcePath, this);
        return;
      }
      const authed = this.state.isAuthenticated;
      const authOk = parsed.requireAuth ? authed : true;
      const required = parsed.groups;
      const userGroups = (_a = this.state.currentGroups) != null ? _a : [];
      const groupOk = required.length > 0 && required.some((g) => userGroups.includes(g));
      if (!authOk || !groupOk) {
        el.createEl("div", { text: "\u{1F512} Access denied." });
        return;
      }
      await import_obsidian2.MarkdownRenderer.renderMarkdown(parsed.body.trim(), el, ctx.sourcePath, this);
    });
    this.registerMarkdownPostProcessor((el, ctx) => {
      var _a;
      if (this.isAdmin()) return;
      const file = this.app.vault.getAbstractFileByPath(ctx.sourcePath);
      if (!file) return;
      const cache = this.app.metadataCache.getFileCache(file);
      const fm = cache == null ? void 0 : cache.frontmatter;
      if (!fm) return;
      const requiredGroups = Array.isArray(fm.dnd_access_groups) ? fm.dnd_access_groups : [];
      if (requiredGroups.length === 0) return;
      const requireAuth = typeof fm.dnd_require_auth === "boolean" ? fm.dnd_require_auth : true;
      const authed = this.state.isAuthenticated;
      const authOk = requireAuth ? authed : true;
      const userGroups = (_a = this.state.currentGroups) != null ? _a : [];
      const groupOk = requiredGroups.some((g) => userGroups.includes(g));
      if (authOk && groupOk) return;
      el.empty();
      const box = el.createDiv({ cls: "authentificator-denied" });
      box.createEl("h3", { text: "\u{1F512} Access denied" });
      if (!this.state.currentCharacter) {
        box.createEl("p", { text: "No character selected." });
        addActionButton(box, "Select character", () => {
          this.app.commands.executeCommandById(
            "obsidian_account_manager:authentificator-select-character"
          );
        });
        return;
      }
      if (!this.state.isAuthenticated) {
        box.createEl("p", { text: "You must login to access this content." });
        addActionButton(box, "Login", () => {
          this.app.commands.executeCommandById(
            "obsidian_account_manager:authentificator-login"
          );
        });
      }
      addActionButton(box, "Open gated note\u2026", () => {
        this.app.commands.executeCommandById(
          "obsidian_account_manager:authentificator-open-gated-note"
        );
      });
    });
  }
  onunload() {
  }
  renderStatus() {
    var _a, _b;
    if (!this.statusEl) return;
    const c = (_a = this.state.currentCharacter) != null ? _a : "none";
    const lock = this.state.isAuthenticated ? "unlocked" : "locked";
    const g = this.isAdmin() ? "ADMIN" : ((_b = this.state.currentGroups) == null ? void 0 : _b.length) ? this.state.currentGroups.join(",") : "-";
    this.statusEl.setText(`authentificator: ${c} (${lock}) [${g}]`);
  }
  isAdmin() {
    return this.state.currentCharacter === "Admin" && this.state.isAuthenticated;
  }
  refreshAllMarkdownViews() {
    this.app.workspace.iterateAllLeaves((leaf) => {
      var _a, _b, _c, _d, _e, _f;
      const view = leaf.view;
      if (!view) return;
      if (((_a = view.getViewType) == null ? void 0 : _a.call(view)) === "markdown") {
        (_c = (_b = view.previewMode) == null ? void 0 : _b.rerender) == null ? void 0 : _c.call(_b, true);
        (_e = (_d = view.currentMode) == null ? void 0 : _d.rerender) == null ? void 0 : _e.call(_d, true);
        (_f = view.render) == null ? void 0 : _f.call(view);
        const file = view.file;
        if (file) {
          leaf.openFile(file, { active: false, state: leaf.getViewState().state }).catch(() => {
          });
        }
      }
    });
  }
  async ensureFolder(path) {
    const existing = this.app.vault.getAbstractFileByPath(path);
    if (existing) return;
    await this.app.vault.createFolder(path).catch(() => {
    });
  }
  async upsertFile(path, content) {
    const existing = this.app.vault.getAbstractFileByPath(path);
    if (existing) {
      await this.app.vault.modify(existing, content);
      return;
    }
    const slash = path.lastIndexOf("/");
    if (slash > 0) {
      const folder = path.substring(0, slash);
      await this.ensureFolder(folder);
    }
    await this.app.vault.create(path, content).catch(() => {
    });
  }
  async ensureUsersFile() {
    const existing = this.app.vault.getAbstractFileByPath(USERS_PATH);
    if (!existing) {
      const db = {
        users: [
          {
            name: "Admin",
            salt: "initAdminSalt",
            hash: "6fADYzT98VWr970cJ2rD/sEmthlRK9Xq71YHrXYZMZM=",
            groups: ["admin", "dm"]
          }
        ]
      };
      await this.upsertFile(USERS_PATH, JSON.stringify(db, null, 2));
      return db;
    }
    const txt = await this.app.vault.read(existing);
    return JSON.parse(txt);
  }
  async loadUsers() {
    var _a;
    const db = await this.ensureUsersFile();
    return (_a = db.users) != null ? _a : [];
  }
  async saveUsers(users) {
    const txt = JSON.stringify({ users }, null, 2);
    await this.upsertFile(USERS_PATH, txt);
  }
  async generateUserReportNote() {
    var _a;
    const REPORT_PATH = "Admin Area/UserReport.md";
    const users = await this.loadUsers();
    const lines = [];
    lines.push("---");
    lines.push("dnd_access_groups: [admin]");
    lines.push("dnd_require_auth: true");
    lines.push("generated: true");
    lines.push("---");
    lines.push("");
    lines.push("# User Report");
    lines.push("");
    lines.push(`Updated: ${(/* @__PURE__ */ new Date()).toISOString()}`);
    lines.push("");
    lines.push("| User | Groups |");
    lines.push("|---|---|");
    for (const u of users) {
      lines.push(`| ${u.name} | ${((_a = u.groups) != null ? _a : []).join(", ") || "-"} |`);
    }
    lines.push("");
    await this.upsertFile(REPORT_PATH, lines.join("\n"));
    return REPORT_PATH;
  }
  async verifyPassword(userName, password) {
    const users = await this.loadUsers();
    const u = users.find((x) => x.name === userName);
    if (!u) return false;
    const candidate = sha256Base64(`${u.salt}:${password}`);
    return candidate === u.hash;
  }
  canAccessFile(file) {
    var _a;
    if (this.isAdmin()) return true;
    const cache = this.app.metadataCache.getFileCache(file);
    const fm = cache == null ? void 0 : cache.frontmatter;
    if (!fm) return false;
    const requiredGroups = Array.isArray(fm.dnd_access_groups) ? fm.dnd_access_groups : [];
    if (requiredGroups.length === 0) return false;
    const requireAuth = typeof fm.dnd_require_auth === "boolean" ? fm.dnd_require_auth : true;
    if (requireAuth && !this.state.isAuthenticated) return false;
    const userGroups = (_a = this.state.currentGroups) != null ? _a : [];
    return requiredGroups.some((g) => userGroups.includes(g));
  }
};
var ButtonUserPickModal = class extends import_obsidian.Modal {
  constructor(app, users, done) {
    super(app);
    this.users = users;
    this.done = done;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h3", { text: "Select character" });
    if (!this.users.length) {
      contentEl.createEl("p", { text: "No users found." });
    } else {
      for (const u of this.users) {
        const btn = contentEl.createEl("button", { text: u.name });
        btn.style.display = "block";
        btn.style.width = "100%";
        btn.style.margin = "0.4rem 0";
        btn.addEventListener("click", () => {
          this.done(u);
          this.close();
        });
      }
    }
    const cancel = contentEl.createEl("button", { text: "Cancel" });
    cancel.style.marginTop = "0.8rem";
    cancel.addEventListener("click", () => {
      this.done(null);
      this.close();
    });
  }
  onClose() {
    this.contentEl.empty();
  }
};
var PasswordModal = class extends import_obsidian.Modal {
  constructor(app, done) {
    super(app);
    this.done = done;
    this.value = "";
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h3", { text: "Enter password" });
    const input = contentEl.createEl("input", { type: "password" });
    input.focus();
    input.addEventListener("input", () => this.value = input.value);
    new import_obsidian.Setting(contentEl).addButton(
      (b) => b.setButtonText("OK").setCta().onClick(() => {
        this.done(this.value);
        this.close();
      })
    ).addButton(
      (b) => b.setButtonText("Cancel").onClick(() => {
        this.done(null);
        this.close();
      })
    );
  }
  onClose() {
    this.contentEl.empty();
  }
};
var CreateUserModal = class extends import_obsidian.Modal {
  constructor(app, done) {
    super(app);
    this.done = done;
    this.name = "";
    this.password = "";
    this.groups = "";
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h3", { text: "Create / Update user" });
    const nameInput = contentEl.createEl("input", {
      type: "text",
      placeholder: "User name (e.g. Castro)"
    });
    nameInput.addEventListener("input", () => this.name = nameInput.value);
    nameInput.focus();
    const passInput = contentEl.createEl("input", {
      type: "password",
      placeholder: "Password"
    });
    passInput.addEventListener("input", () => this.password = passInput.value);
    const groupsInput = contentEl.createEl("input", {
      type: "text",
      placeholder: "Groups (comma separated), e.g. party, house_cannith"
    });
    groupsInput.addEventListener("input", () => this.groups = groupsInput.value);
    new import_obsidian.Setting(contentEl).addButton(
      (b) => b.setButtonText("Save").setCta().onClick(() => {
        this.done({ name: this.name, password: this.password, groups: this.groups });
        this.close();
      })
    ).addButton(
      (b) => b.setButtonText("Cancel").onClick(() => {
        this.done(null);
        this.close();
      })
    );
  }
  onClose() {
    this.contentEl.empty();
  }
};
var SingleLineModal = class extends import_obsidian.Modal {
  constructor(app, title, placeholder, done) {
    super(app);
    this.title = title;
    this.placeholder = placeholder;
    this.done = done;
    this.value = "";
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h3", { text: this.title });
    const input = contentEl.createEl("input", {
      type: "text",
      placeholder: this.placeholder
    });
    input.addEventListener("input", () => this.value = input.value);
    input.focus();
    new import_obsidian.Setting(contentEl).addButton(
      (b) => b.setButtonText("OK").setCta().onClick(() => {
        this.done(this.value.trim() || null);
        this.close();
      })
    ).addButton(
      (b) => b.setButtonText("Cancel").onClick(() => {
        this.done(null);
        this.close();
      })
    );
  }
  onClose() {
    this.contentEl.empty();
  }
};
var UserPickModal = class extends import_obsidian.FuzzySuggestModal {
  constructor(app, users, done) {
    super(app);
    this.users = users;
    this.done = done;
    this.hasResolved = false;
    this.setPlaceholder("Pick a user\u2026");
  }
  getItems() {
    return this.users;
  }
  getItemText(item) {
    return item.name;
  }
  onChooseItem(item) {
    if (this.hasResolved) return;
    this.hasResolved = true;
    this.done(item);
    this.close();
  }
  onClose() {
    super.onClose();
    if (this.hasResolved) return;
    this.hasResolved = true;
    this.done(null);
  }
};
var LiveFilePickModal = class extends import_obsidian.FuzzySuggestModal {
  constructor(app, plugin) {
    super(app);
    this.plugin = plugin;
    this.setPlaceholder("Type to search gated notes\u2026");
  }
  getItems() {
    const files = this.plugin.app.vault.getMarkdownFiles();
    return files.filter((f) => this.plugin.canAccessFile(f));
  }
  getItemText(item) {
    return item.path;
  }
  async onChooseItem(item) {
    await this.plugin.app.workspace.getLeaf(true).openFile(item);
  }
};
var StatusMenuModal = class extends import_obsidian.Modal {
  constructor(app, plugin) {
    super(app);
    this.plugin = plugin;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h3", { text: "authentificator" });
    new import_obsidian.Setting(contentEl).setName("Select character").addButton(
      (b) => b.setButtonText("Open").onClick(() => {
        this.close();
        this.plugin.app.commands.executeCommandById(
          "obsidian_account_manager:authentificator-select-character"
        );
      })
    );
    new import_obsidian.Setting(contentEl).setName("Login (password)").addButton(
      (b) => b.setButtonText("Open").onClick(() => {
        this.close();
        this.plugin.app.commands.executeCommandById(
          "obsidian_account_manager:authentificator-login"
        );
      })
    );
    new import_obsidian.Setting(contentEl).setName("Open gated note\u2026").addButton(
      (b) => b.setButtonText("Open").onClick(() => {
        this.close();
        this.plugin.app.commands.executeCommandById(
          "obsidian_account_manager:authentificator-open-gated-note"
        );
      })
    );
    new import_obsidian.Setting(contentEl).setName("Logout").addButton(
      (b) => b.setButtonText("Do it").onClick(() => {
        this.close();
        this.plugin.app.commands.executeCommandById(
          "obsidian_account_manager:authentificator-logout"
        );
      })
    );
    if (this.plugin.isAdmin()) {
      contentEl.createEl("hr");
      new import_obsidian.Setting(contentEl).setName("Admin: Create/Update user").addButton(
        (b) => b.setButtonText("Open").onClick(() => {
          this.close();
          this.plugin.app.commands.executeCommandById(
            "obsidian_account_manager:authentificator-admin-create-update-user"
          );
        })
      );
      new import_obsidian.Setting(contentEl).setName("Admin: Toggle group for user").addButton(
        (b) => b.setButtonText("Open").onClick(() => {
          this.close();
          this.plugin.app.commands.executeCommandById(
            "obsidian_account_manager:authentificator-admin-toggle-group"
          );
        })
      );
      new import_obsidian.Setting(contentEl).setName("Admin: Toggle group for ALL players").addButton(
        (b) => b.setButtonText("Open").onClick(() => {
          this.close();
          this.plugin.app.commands.executeCommandById(
            "obsidian_account_manager:authentificator-admin-toggle-group-all"
          );
        })
      );
      new import_obsidian.Setting(contentEl).setName("Admin: Reset temporary groups").addButton(
        (b) => b.setButtonText("Open").onClick(() => {
          this.close();
          this.plugin.app.commands.executeCommandById(
            "obsidian_account_manager:authentificator-admin-reset-temp-groups"
          );
        })
      );
      new import_obsidian.Setting(contentEl).setName("Admin: Who has group?").addButton(
        (b) => b.setButtonText("Open").onClick(() => {
          this.close();
          this.plugin.app.commands.executeCommandById(
            "obsidian_account_manager:authentificator-admin-who-has-group"
          );
        })
      );
    }
  }
  onClose() {
    this.contentEl.empty();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7XHJcbiAgQXBwLFxyXG4gIE1vZGFsLFxyXG4gIE5vdGljZSxcclxuICBQbHVnaW4sXHJcbiAgU2V0dGluZyxcclxuICBGdXp6eVN1Z2dlc3RNb2RhbCxcclxuICBURmlsZSxcclxufSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgY3JlYXRlSGFzaCwgcmFuZG9tQnl0ZXMgfSBmcm9tIFwiY3J5cHRvXCI7XHJcbmltcG9ydCB7IGFkZEFib3J0U2lnbmFsIH0gZnJvbSBcInN0cmVhbVwiO1xyXG5pbXBvcnQgeyBNYXJrZG93blJlbmRlcmVyIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5cclxudHlwZSBBdXRoU3RhdGUgPSB7XHJcbiAgY3VycmVudENoYXJhY3Rlcjogc3RyaW5nIHwgbnVsbDtcclxuICBpc0F1dGhlbnRpY2F0ZWQ6IGJvb2xlYW47XHJcbiAgY3VycmVudEdyb3Vwczogc3RyaW5nW107XHJcbn07XHJcblxyXG50eXBlIFVzZXJFbnRyeSA9IHsgbmFtZTogc3RyaW5nOyBzYWx0OiBzdHJpbmc7IGhhc2g6IHN0cmluZzsgZ3JvdXBzPzogc3RyaW5nW10gfTtcclxudHlwZSBVc2Vyc0RiID0geyB1c2VyczogVXNlckVudHJ5W10gfTtcclxuXHJcbmNvbnN0IFVTRVJTX1BBVEggPSBcIkRuREF1dGgvdXNlcnMuanNvblwiO1xyXG5jb25zdCBERUZBVUxUX1NUQVRFOiBBdXRoU3RhdGUgPSB7XHJcbiAgY3VycmVudENoYXJhY3RlcjogbnVsbCxcclxuICBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLFxyXG4gIGN1cnJlbnRHcm91cHM6IFtdLFxyXG59O1xyXG5cclxuZnVuY3Rpb24gc2hhMjU2QmFzZTY0KHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIGNyZWF0ZUhhc2goXCJzaGEyNTZcIikudXBkYXRlKHRleHQsIFwidXRmOFwiKS5kaWdlc3QoXCJiYXNlNjRcIik7XHJcbn1cclxuZnVuY3Rpb24gbWFrZVNhbHQoYnl0ZXMgPSAxNik6IHN0cmluZyB7XHJcbiAgcmV0dXJuIHJhbmRvbUJ5dGVzKGJ5dGVzKS50b1N0cmluZyhcImJhc2U2NFwiKTtcclxufVxyXG5cclxuZnVuY3Rpb24gYWRkQWN0aW9uQnV0dG9uKHBhcmVudDogSFRNTEVsZW1lbnQsIGxhYmVsOiBzdHJpbmcsIGFjdGlvbjogKCkgPT4gdm9pZCkge1xyXG4gIGNvbnN0IGJ0biA9IHBhcmVudC5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IGxhYmVsIH0pO1xyXG4gIGJ0bi5zdHlsZS5tYXJnaW5SaWdodCA9IFwiMC41cmVtXCI7XHJcbiAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhY3Rpb24pO1xyXG59XHJcblxyXG50eXBlIERuZEdhdGVQYXJzZWQgPSB7IGdyb3Vwczogc3RyaW5nW107IGJvZHk6IHN0cmluZzsgcmVxdWlyZUF1dGg6IGJvb2xlYW4gfTtcclxuZnVuY3Rpb24gcGFyc2VEbmRHYXRlKHNvdXJjZTogc3RyaW5nKTogRG5kR2F0ZVBhcnNlZCB7XHJcbiAgY29uc3QgbGluZXMgPSBzb3VyY2Uuc3BsaXQoXCJcXG5cIik7XHJcbiAgbGV0IGdyb3Vwczogc3RyaW5nW10gPSBbXTtcclxuICBsZXQgcmVxdWlyZUF1dGggPSB0cnVlOyAvLyBcdTI3MDUgZGVmYXVsdCBUUlVFXHJcbiAgbGV0IHN0YXJ0Qm9keUF0ID0gMDtcclxuXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xyXG4gICAgY29uc3QgbGluZSA9IGxpbmVzW2ldLnRyaW0oKTtcclxuICAgIGlmIChsaW5lID09PSBcIi0tLVwiKSB7XHJcbiAgICAgIHN0YXJ0Qm9keUF0ID0gaSArIDE7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgaWYgKCFsaW5lKSBjb250aW51ZTtcclxuXHJcbiAgICBjb25zdCBtZyA9IGxpbmUubWF0Y2goL15ncm91cHNcXHMqOlxccyooLispJC9pKTtcclxuICAgIGlmIChtZykge1xyXG4gICAgICBncm91cHMgPSBtZ1sxXS5zcGxpdChcIixcIikubWFwKChzKSA9PiBzLnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pO1xyXG4gICAgICBjb250aW51ZTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBtYSA9IGxpbmUubWF0Y2goL15yZXF1aXJlQXV0aFxccyo6XFxzKih0cnVlfGZhbHNlKSQvaSk7XHJcbiAgICBpZiAobWEpIHtcclxuICAgICAgcmVxdWlyZUF1dGggPSBtYVsxXS50b0xvd2VyQ2FzZSgpID09PSBcInRydWVcIjtcclxuICAgICAgY29udGludWU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb25zdCBib2R5ID0gbGluZXMuc2xpY2Uoc3RhcnRCb2R5QXQpLmpvaW4oXCJcXG5cIik7XHJcbiAgcmV0dXJuIHsgZ3JvdXBzLCBib2R5LCByZXF1aXJlQXV0aCB9O1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBdXRoZW50aWZpY2F0b3JQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xyXG4gIHByaXZhdGUgc3RhdGU6IEF1dGhTdGF0ZSA9IHsgLi4uREVGQVVMVF9TVEFURSB9O1xyXG4gIHByaXZhdGUgc3RhdHVzRWw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblxyXG4gIGFzeW5jIG9ubG9hZCgpIHtcclxuICAgIHRoaXMuc3RhdGUgPSB7IC4uLkRFRkFVTFRfU1RBVEUsIC4uLihhd2FpdCB0aGlzLmxvYWREYXRhKCkpIH07XHJcbiAgICBhd2FpdCB0aGlzLmVuc3VyZVVzZXJzRmlsZSgpO1xyXG5cclxuICAgIC8vIFN0YXR1c2JhclxyXG4gICAgdGhpcy5zdGF0dXNFbCA9IHRoaXMuYWRkU3RhdHVzQmFySXRlbSgpO1xyXG4gICAgdGhpcy5yZW5kZXJTdGF0dXMoKTtcclxuICAgIGlmICh0aGlzLnN0YXR1c0VsKSB7XHJcbiAgICAgIHRoaXMuc3RhdHVzRWwuc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XHJcbiAgICAgIHRoaXMuc3RhdHVzRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICBuZXcgU3RhdHVzTWVudU1vZGFsKHRoaXMuYXBwLCB0aGlzKS5vcGVuKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMucmVnaXN0ZXJNYXJrZG93bkNvZGVCbG9ja1Byb2Nlc3NvcihcImRuZGFkbWluXCIsIGFzeW5jIChzb3VyY2UsIGVsKSA9PiB7XHJcbiAgICAgIGlmICghdGhpcy5pc0FkbWluKCkpIHtcclxuICAgICAgICBlbC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IFwiXHVEODNEXHVERDEyIEFkbWluIG9ubHkuXCIgfSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBCdXR0b25zIHJvd1xyXG4gICAgICBjb25zdCByb3cgPSBlbC5jcmVhdGVEaXYoKTtcclxuXHJcbiAgICAgIGNvbnN0IGNyZWF0ZUJ0biA9IHJvdy5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IFwiQ3JlYXRlIC8gVXBkYXRlIHVzZXJcIiB9KTtcclxuICAgICAgY3JlYXRlQnRuLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5hcHAuY29tbWFuZHMuZXhlY3V0ZUNvbW1hbmRCeUlkKFxyXG4gICAgICAgICAgXCJvYnNpZGlhbl9hY2NvdW50X21hbmFnZXI6YXV0aGVudGlmaWNhdG9yLWFkbWluLWNyZWF0ZS11cGRhdGUtdXNlclwiXHJcbiAgICAgICAgKTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlcG9ydEJ0biA9IHJvdy5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IFwiUmVnZW5lcmF0ZSByZXBvcnRcIiB9KTtcclxuICAgICAgcmVwb3J0QnRuLnN0eWxlLm1hcmdpbkxlZnQgPSBcIjAuNXJlbVwiO1xyXG4gICAgICByZXBvcnRCdG4ub25jbGljayA9IGFzeW5jICgpID0+IHtcclxuICAgICAgICBhd2FpdCB0aGlzLmdlbmVyYXRlVXNlclJlcG9ydE5vdGUoKTtcclxuICAgICAgICB0aGlzLnJlZnJlc2hBbGxNYXJrZG93blZpZXdzKCk7XHJcbiAgICAgICAgbmV3IE5vdGljZShcIlx1MjcwNSBSZXBvcnQgdXBkYXRlZFwiKTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGVsLmNyZWF0ZUVsKFwiaHJcIik7XHJcblxyXG4gICAgICAvLyBMaXZlIHVzZXIgbGlzdFxyXG4gICAgICBjb25zdCB1c2VycyA9IGF3YWl0IHRoaXMubG9hZFVzZXJzKCk7XHJcbiAgICAgIGZvciAoY29uc3QgdSBvZiB1c2Vycykge1xyXG4gICAgICAgIGVsLmNyZWF0ZURpdih7XHJcbiAgICAgICAgICB0ZXh0OiBgJHt1Lm5hbWV9IFx1MjAxNCAkeyh1Lmdyb3VwcyA/PyBbXSkuam9pbihcIiwgXCIpIHx8IFwiLVwifWAsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICAvLyAtLS0gQ29tbWFuZHMgLS0tXHJcbiAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICBpZDogXCJhdXRoZW50aWZpY2F0b3ItYWRtaW4tc2V0dXAtYWRtaW4tYXJlYVwiLFxyXG4gICAgICBuYW1lOiBcIkFkbWluOiBTZXR1cCBBZG1pbiBBcmVhXCIsXHJcbiAgICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQWRtaW4oKSkge1xyXG4gICAgICAgICAgbmV3IE5vdGljZShcIlx1RDgzRFx1REVBQiBBZG1pbiBvbmx5LiBQbGVhc2UgbG9naW4gYXMgQWRtaW4uXCIpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYXdhaXQgdGhpcy5lbnN1cmVGb2xkZXIoXCJBZG1pbiBBcmVhXCIpO1xyXG5cclxuICAgICAgICBhd2FpdCB0aGlzLnVwc2VydEZpbGUoXHJcbiAgICAgICAgICBcIkFkbWluIEFyZWEvVXNlck1hbmFnZW1lbnQubWRcIixcclxuICAgICAgICAgIFtcclxuICAgICAgICAgICAgXCItLS1cIixcclxuICAgICAgICAgICAgXCJkbmRfYWNjZXNzX2dyb3VwczogW2FkbWluXVwiLFxyXG4gICAgICAgICAgICBcImRuZF9yZXF1aXJlX2F1dGg6IHRydWVcIixcclxuICAgICAgICAgICAgXCJnZW5lcmF0ZWQ6IHRydWVcIixcclxuICAgICAgICAgICAgXCItLS1cIixcclxuICAgICAgICAgICAgXCJcIixcclxuICAgICAgICAgICAgXCIjIEFkbWluIEFyZWEgXHUyMDEzIFVzZXIgTWFuYWdlbWVudFwiLFxyXG4gICAgICAgICAgICBcIlwiLFxyXG4gICAgICAgICAgICBcImBgYGRuZGFkbWluXCIsXHJcbiAgICAgICAgICAgIFwibW9kZTogdXNlcnNcIixcclxuICAgICAgICAgICAgXCJgYGBcIixcclxuICAgICAgICAgICAgXCJcIixcclxuICAgICAgICAgIF0uam9pbihcIlxcblwiKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGF3YWl0IHRoaXMuZ2VuZXJhdGVVc2VyUmVwb3J0Tm90ZSgpOyAvLyBlcnN0ZWxsdC9ha3R1YWxpc2llcnQgQWRtaW4gQXJlYS9Vc2VyUmVwb3J0Lm1kXHJcbiAgICAgICAgdGhpcy5yZWZyZXNoQWxsTWFya2Rvd25WaWV3cygpO1xyXG5cclxuICAgICAgICBjb25zdCBmID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKFwiQWRtaW4gQXJlYS9Vc2VyTWFuYWdlbWVudC5tZFwiKTtcclxuICAgICAgICBpZiAoZikgYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYodHJ1ZSkub3BlbkZpbGUoZiBhcyBhbnkpO1xyXG4gICAgICAgIG5ldyBOb3RpY2UoXCJcdTI3MDUgQWRtaW4gQXJlYSBjcmVhdGVkL3VwZGF0ZWQuXCIpO1xyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5hZGRDb21tYW5kKHtcclxuICAgICAgaWQ6IFwiYXV0aGVudGlmaWNhdG9yLXNlbGVjdC1jaGFyYWN0ZXJcIixcclxuICAgICAgbmFtZTogXCJTZWxlY3QgY2hhcmFjdGVyXCIsXHJcbiAgICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdXNlcnMgPSBhd2FpdCB0aGlzLmxvYWRVc2VycygpO1xyXG4gICAgICAgIGNvbnN0IHBpY2tlZCA9IGF3YWl0IG5ldyBQcm9taXNlPFVzZXJFbnRyeSB8IG51bGw+KChyZXNvbHZlKSA9PiB7XHJcbiAgICAgICAgICBuZXcgQnV0dG9uVXNlclBpY2tNb2RhbCh0aGlzLmFwcCwgdXNlcnMsIHJlc29sdmUpLm9wZW4oKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKCFwaWNrZWQpIHJldHVybjtcclxuXHJcbiAgICAgICAgdGhpcy5zdGF0ZS5jdXJyZW50Q2hhcmFjdGVyID0gcGlja2VkLm5hbWU7XHJcbiAgICAgICAgdGhpcy5zdGF0ZS5pc0F1dGhlbnRpY2F0ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnN0YXRlLmN1cnJlbnRHcm91cHMgPSBbXTtcclxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc3RhdGUpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyU3RhdHVzKCk7XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoQWxsTWFya2Rvd25WaWV3cygpO1xyXG4gICAgICAgIG5ldyBOb3RpY2UoYFNlbGVjdGVkIGNoYXJhY3RlcjogJHtwaWNrZWQubmFtZX1gKTtcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgIGlkOiBcImF1dGhlbnRpZmljYXRvci1sb2dpblwiLFxyXG4gICAgICBuYW1lOiBcIkxvZ2luIChwYXNzd29yZClcIixcclxuICAgICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCB1c2VyID0gdGhpcy5zdGF0ZS5jdXJyZW50Q2hhcmFjdGVyO1xyXG4gICAgICAgIGlmICghdXNlcikge1xyXG4gICAgICAgICAgbmV3IE5vdGljZShcIlNlbGVjdCBhIGNoYXJhY3RlciBmaXJzdC5cIik7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBwYXNzd29yZCA9IGF3YWl0IG5ldyBQcm9taXNlPHN0cmluZyB8IG51bGw+KChyZXNvbHZlKSA9PiB7XHJcbiAgICAgICAgICBuZXcgUGFzc3dvcmRNb2RhbCh0aGlzLmFwcCwgcmVzb2x2ZSkub3BlbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICghcGFzc3dvcmQpIHJldHVybjtcclxuXHJcbiAgICAgICAgY29uc3Qgb2sgPSBhd2FpdCB0aGlzLnZlcmlmeVBhc3N3b3JkKHVzZXIsIHBhc3N3b3JkKTtcclxuICAgICAgICBpZiAoIW9rKSB7XHJcbiAgICAgICAgICB0aGlzLnN0YXRlLmlzQXV0aGVudGljYXRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgdGhpcy5zdGF0ZS5jdXJyZW50R3JvdXBzID0gW107XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc3RhdGUpO1xyXG4gICAgICAgICAgdGhpcy5yZW5kZXJTdGF0dXMoKTtcclxuICAgICAgICAgIHRoaXMucmVmcmVzaEFsbE1hcmtkb3duVmlld3MoKTtcclxuICAgICAgICAgIG5ldyBOb3RpY2UoXCJcdTI3NEMgTG9naW4gZmFpbGVkLlwiKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHVzZXJzID0gYXdhaXQgdGhpcy5sb2FkVXNlcnMoKTtcclxuICAgICAgICBjb25zdCBlbnRyeSA9IHVzZXJzLmZpbmQoKHUpID0+IHUubmFtZSA9PT0gdXNlcik7XHJcblxyXG4gICAgICAgIHRoaXMuc3RhdGUuaXNBdXRoZW50aWNhdGVkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnN0YXRlLmN1cnJlbnRHcm91cHMgPSAoZW50cnk/Lmdyb3VwcyA/PyBbXSkubWFwKFN0cmluZyk7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnN0YXRlKTtcclxuICAgICAgICB0aGlzLnJlbmRlclN0YXR1cygpO1xyXG4gICAgICAgIHRoaXMucmVmcmVzaEFsbE1hcmtkb3duVmlld3MoKTtcclxuICAgICAgICBuZXcgTm90aWNlKGBcdTI3MDUgTG9nZ2VkIGluIGFzICR7dXNlcn1gKTtcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgIGlkOiBcImF1dGhlbnRpZmljYXRvci1sb2dvdXRcIixcclxuICAgICAgbmFtZTogXCJMb2dvdXRcIixcclxuICAgICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcclxuICAgICAgICB0aGlzLnN0YXRlID0geyAuLi5ERUZBVUxUX1NUQVRFIH07XHJcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnN0YXRlKTtcclxuICAgICAgICB0aGlzLnJlbmRlclN0YXR1cygpO1xyXG4gICAgICAgIHRoaXMucmVmcmVzaEFsbE1hcmtkb3duVmlld3MoKTtcclxuICAgICAgICBuZXcgTm90aWNlKFwiTG9nZ2VkIG91dC5cIik7XHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICBpZDogXCJhdXRoZW50aWZpY2F0b3Itb3Blbi1nYXRlZC1ub3RlXCIsXHJcbiAgICAgIG5hbWU6IFwiT3BlbiBnYXRlZCBub3RlXHUyMDI2XCIsXHJcbiAgICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQWRtaW4oKSAmJiAhdGhpcy5zdGF0ZS5pc0F1dGhlbnRpY2F0ZWQpIHtcclxuICAgICAgICAgIG5ldyBOb3RpY2UoXCJQbGVhc2UgbG9naW4gZmlyc3QuXCIpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBuZXcgTGl2ZUZpbGVQaWNrTW9kYWwodGhpcy5hcHAsIHRoaXMpLm9wZW4oKTtcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIC0tLSBBZG1pbjogQ3JlYXRlL1VwZGF0ZSB1c2VyIC0tLVxyXG4gICAgdGhpcy5hZGRDb21tYW5kKHtcclxuICAgICAgaWQ6IFwiYXV0aGVudGlmaWNhdG9yLWFkbWluLWNyZWF0ZS11cGRhdGUtdXNlclwiLFxyXG4gICAgICBuYW1lOiBcIkFkbWluOiBDcmVhdGUvVXBkYXRlIHVzZXJcIixcclxuICAgICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNBZG1pbigpKSB7XHJcbiAgICAgICAgICBuZXcgTm90aWNlKFwiXHVEODNEXHVERUFCIEFkbWluIG9ubHkuIFBsZWFzZSBsb2dpbiBhcyBBZG1pbi5cIik7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBuZXcgUHJvbWlzZTxcclxuICAgICAgICAgIHsgbmFtZTogc3RyaW5nOyBwYXNzd29yZDogc3RyaW5nOyBncm91cHM6IHN0cmluZyB9IHwgbnVsbFxyXG4gICAgICAgID4oKHJlc29sdmUpID0+IHtcclxuICAgICAgICAgIG5ldyBDcmVhdGVVc2VyTW9kYWwodGhpcy5hcHAsIHJlc29sdmUpLm9wZW4oKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoIXJlc3VsdCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBjb25zdCBuYW1lID0gcmVzdWx0Lm5hbWUudHJpbSgpO1xyXG4gICAgICAgIGNvbnN0IHBhc3N3b3JkID0gcmVzdWx0LnBhc3N3b3JkO1xyXG4gICAgICAgIGlmICghbmFtZSkgcmV0dXJuIHZvaWQgbmV3IE5vdGljZShcIlVzZXIgbmFtZSBjYW5ub3QgYmUgZW1wdHkuXCIpO1xyXG4gICAgICAgIGlmICghcGFzc3dvcmQpIHJldHVybiB2b2lkIG5ldyBOb3RpY2UoXCJQYXNzd29yZCBjYW5ub3QgYmUgZW1wdHkuXCIpO1xyXG5cclxuICAgICAgICBsZXQgZ3JvdXBzID0gcmVzdWx0Lmdyb3Vwc1xyXG4gICAgICAgICAgLnNwbGl0KFwiLFwiKVxyXG4gICAgICAgICAgLm1hcCgocykgPT4gcy50cmltKCkpXHJcbiAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pO1xyXG5cclxuICAgICAgICAvLyBBZG1pbiBzYWZldHlcclxuICAgICAgICBpZiAobmFtZSA9PT0gXCJBZG1pblwiICYmICFncm91cHMuaW5jbHVkZXMoXCJhZG1pblwiKSkgZ3JvdXBzLnB1c2goXCJhZG1pblwiKTtcclxuXHJcbiAgICAgICAgY29uc3QgdXNlcnMgPSBhd2FpdCB0aGlzLmxvYWRVc2VycygpO1xyXG4gICAgICAgIGNvbnN0IHNhbHQgPSBtYWtlU2FsdCgpO1xyXG4gICAgICAgIGNvbnN0IGhhc2ggPSBzaGEyNTZCYXNlNjQoYCR7c2FsdH06JHtwYXNzd29yZH1gKTtcclxuXHJcbiAgICAgICAgY29uc3QgaWR4ID0gdXNlcnMuZmluZEluZGV4KCh1KSA9PiB1Lm5hbWUgPT09IG5hbWUpO1xyXG4gICAgICAgIGNvbnN0IGVudHJ5OiBVc2VyRW50cnkgPSB7IG5hbWUsIHNhbHQsIGhhc2gsIGdyb3VwcyB9O1xyXG5cclxuICAgICAgICBpZiAoaWR4ID49IDApIHVzZXJzW2lkeF0gPSBlbnRyeTtcclxuICAgICAgICBlbHNlIHVzZXJzLnB1c2goZW50cnkpO1xyXG5cclxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVVc2Vycyh1c2Vycyk7XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoQWxsTWFya2Rvd25WaWV3cygpO1xyXG4gICAgICAgIG5ldyBOb3RpY2UoYFx1MjcwNSBTYXZlZCB1c2VyOiAke25hbWV9YCk7XHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyAtLS0gQWRtaW46IFRvZ2dsZSBncm91cCBmb3IgdXNlciAtLS1cclxuICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgIGlkOiBcImF1dGhlbnRpZmljYXRvci1hZG1pbi10b2dnbGUtZ3JvdXBcIixcclxuICAgICAgbmFtZTogXCJBZG1pbjogVG9nZ2xlIGdyb3VwIGZvciB1c2VyXCIsXHJcbiAgICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQWRtaW4oKSkge1xyXG4gICAgICAgICAgbmV3IE5vdGljZShcIlx1RDgzRFx1REVBQiBBZG1pbiBvbmx5LiBQbGVhc2UgbG9naW4gYXMgQWRtaW4uXCIpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgZ3JvdXAgPSBhd2FpdCBuZXcgUHJvbWlzZTxzdHJpbmcgfCBudWxsPigocmVzb2x2ZSkgPT4ge1xyXG4gICAgICAgICAgbmV3IFNpbmdsZUxpbmVNb2RhbChcclxuICAgICAgICAgICAgdGhpcy5hcHAsXHJcbiAgICAgICAgICAgIFwiVG9nZ2xlIGdyb3VwXCIsXHJcbiAgICAgICAgICAgIFwiR3JvdXAgbmFtZSAoZS5nLiBzZXNzaW9uXzA3X3JldmVhbClcIixcclxuICAgICAgICAgICAgcmVzb2x2ZVxyXG4gICAgICAgICAgKS5vcGVuKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKCFncm91cCkgcmV0dXJuO1xyXG4gICAgICAgIGNvbnN0IGcgPSBncm91cC50cmltKCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHVzZXJzID0gYXdhaXQgdGhpcy5sb2FkVXNlcnMoKTtcclxuICAgICAgICBjb25zdCBwaWNrZWQgPSBhd2FpdCBuZXcgUHJvbWlzZTxVc2VyRW50cnkgfCBudWxsPigocmVzb2x2ZSkgPT4ge1xyXG4gICAgICAgICAgbmV3IFVzZXJQaWNrTW9kYWwoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICB1c2Vycy5maWx0ZXIoKHUpID0+IHUubmFtZSAhPT0gXCJBZG1pblwiKSxcclxuICAgICAgICAgICAgcmVzb2x2ZVxyXG4gICAgICAgICAgKS5vcGVuKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKCFwaWNrZWQpIHJldHVybjtcclxuXHJcbiAgICAgICAgY29uc3QgaWR4ID0gdXNlcnMuZmluZEluZGV4KCh1KSA9PiB1Lm5hbWUgPT09IHBpY2tlZC5uYW1lKTtcclxuICAgICAgICBpZiAoaWR4IDwgMCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBjb25zdCBzZXQgPSBuZXcgU2V0KCh1c2Vyc1tpZHhdLmdyb3VwcyA/PyBbXSkubWFwKFN0cmluZykpO1xyXG4gICAgICAgIGxldCBhY3Rpb246IFwiYWRkZWRcIiB8IFwicmVtb3ZlZFwiO1xyXG4gICAgICAgIGlmIChzZXQuaGFzKGcpKSB7XHJcbiAgICAgICAgICBzZXQuZGVsZXRlKGcpO1xyXG4gICAgICAgICAgYWN0aW9uID0gXCJyZW1vdmVkXCI7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHNldC5hZGQoZyk7XHJcbiAgICAgICAgICBhY3Rpb24gPSBcImFkZGVkXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHVzZXJzW2lkeF0uZ3JvdXBzID0gQXJyYXkuZnJvbShzZXQpO1xyXG5cclxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVVc2Vycyh1c2Vycyk7XHJcblxyXG4gICAgICAgIC8vIHJlZnJlc2ggc2Vzc2lvbiBncm91cHMgaWYgc2FtZSB1c2VyIGN1cnJlbnRseSBsb2dnZWQgaW5cclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICB0aGlzLnN0YXRlLmN1cnJlbnRDaGFyYWN0ZXIgPT09IHVzZXJzW2lkeF0ubmFtZSAmJlxyXG4gICAgICAgICAgdGhpcy5zdGF0ZS5pc0F1dGhlbnRpY2F0ZWRcclxuICAgICAgICApIHtcclxuICAgICAgICAgIHRoaXMuc3RhdGUuY3VycmVudEdyb3VwcyA9IHVzZXJzW2lkeF0uZ3JvdXBzID8/IFtdO1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnN0YXRlKTtcclxuICAgICAgICAgIHRoaXMucmVuZGVyU3RhdHVzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnJlZnJlc2hBbGxNYXJrZG93blZpZXdzKCk7XHJcbiAgICAgICAgbmV3IE5vdGljZShcclxuICAgICAgICAgIGBcdTI3MDUgJHthY3Rpb24udG9VcHBlckNhc2UoKX06IFwiJHtnfVwiICR7YWN0aW9uID09PSBcImFkZGVkXCIgPyBcInRvXCIgOiBcImZyb21cIlxyXG4gICAgICAgICAgfSAke3BpY2tlZC5uYW1lfWBcclxuICAgICAgICApO1xyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gLS0tIEFkbWluOiBUb2dnbGUgZ3JvdXAgZm9yIEFMTCBwbGF5ZXJzIC0tLVxyXG4gICAgdGhpcy5hZGRDb21tYW5kKHtcclxuICAgICAgaWQ6IFwiYXV0aGVudGlmaWNhdG9yLWFkbWluLXRvZ2dsZS1ncm91cC1hbGxcIixcclxuICAgICAgbmFtZTogXCJBZG1pbjogVG9nZ2xlIGdyb3VwIGZvciBBTEwgcGxheWVyc1wiLFxyXG4gICAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGlmICghdGhpcy5pc0FkbWluKCkpIHtcclxuICAgICAgICAgIG5ldyBOb3RpY2UoXCJcdUQ4M0RcdURFQUIgQWRtaW4gb25seS4gUGxlYXNlIGxvZ2luIGFzIEFkbWluLlwiKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGdyb3VwID0gYXdhaXQgbmV3IFByb21pc2U8c3RyaW5nIHwgbnVsbD4oKHJlc29sdmUpID0+IHtcclxuICAgICAgICAgIG5ldyBTaW5nbGVMaW5lTW9kYWwoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICBcIlRvZ2dsZSBncm91cCBmb3IgQUxMXCIsXHJcbiAgICAgICAgICAgIFwiR3JvdXAgbmFtZSAoZS5nLiBzZXNzaW9uXzA3X3JldmVhbClcIixcclxuICAgICAgICAgICAgcmVzb2x2ZVxyXG4gICAgICAgICAgKS5vcGVuKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKCFncm91cCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBjb25zdCBnID0gZ3JvdXAudHJpbSgpO1xyXG4gICAgICAgIGNvbnN0IHVzZXJzID0gYXdhaXQgdGhpcy5sb2FkVXNlcnMoKTtcclxuICAgICAgICBjb25zdCBwbGF5ZXJzID0gdXNlcnMuZmlsdGVyKCh1KSA9PiB1Lm5hbWUgIT09IFwiQWRtaW5cIik7XHJcblxyXG4gICAgICAgIGNvbnN0IGNvdW50SGFzID0gcGxheWVycy5maWx0ZXIoKHUpID0+ICh1Lmdyb3VwcyA/PyBbXSkuaW5jbHVkZXMoZykpXHJcbiAgICAgICAgICAubGVuZ3RoO1xyXG4gICAgICAgIGNvbnN0IHNob3VsZEFkZCA9IGNvdW50SGFzIDwgTWF0aC5jZWlsKHBsYXllcnMubGVuZ3RoIC8gMik7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgdSBvZiBwbGF5ZXJzKSB7XHJcbiAgICAgICAgICBjb25zdCBzZXQgPSBuZXcgU2V0KCh1Lmdyb3VwcyA/PyBbXSkubWFwKFN0cmluZykpO1xyXG4gICAgICAgICAgaWYgKHNob3VsZEFkZCkgc2V0LmFkZChnKTtcclxuICAgICAgICAgIGVsc2Ugc2V0LmRlbGV0ZShnKTtcclxuICAgICAgICAgIHUuZ3JvdXBzID0gQXJyYXkuZnJvbShzZXQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlVXNlcnModXNlcnMpO1xyXG4gICAgICAgIHRoaXMucmVmcmVzaEFsbE1hcmtkb3duVmlld3MoKTtcclxuICAgICAgICBuZXcgTm90aWNlKFxyXG4gICAgICAgICAgYFx1MjcwNSAke3Nob3VsZEFkZCA/IFwiQWRkZWRcIiA6IFwiUmVtb3ZlZFwifSBcIiR7Z31cIiAke3Nob3VsZEFkZCA/IFwidG9cIiA6IFwiZnJvbVwiXHJcbiAgICAgICAgICB9IEFMTCBwbGF5ZXJzYFxyXG4gICAgICAgICk7XHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyAtLS0gQWRtaW46IFJlc2V0IHRlbXBvcmFyeSBncm91cHMgKHByZWZpeCkgLS0tXHJcbiAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICBpZDogXCJhdXRoZW50aWZpY2F0b3ItYWRtaW4tcmVzZXQtdGVtcC1ncm91cHNcIixcclxuICAgICAgbmFtZTogXCJBZG1pbjogUmVzZXQgdGVtcG9yYXJ5IGdyb3Vwc1wiLFxyXG4gICAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGlmICghdGhpcy5pc0FkbWluKCkpIHtcclxuICAgICAgICAgIG5ldyBOb3RpY2UoXCJcdUQ4M0RcdURFQUIgQWRtaW4gb25seS4gUGxlYXNlIGxvZ2luIGFzIEFkbWluLlwiKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHByZWZpeCA9IGF3YWl0IG5ldyBQcm9taXNlPHN0cmluZyB8IG51bGw+KChyZXNvbHZlKSA9PiB7XHJcbiAgICAgICAgICBuZXcgU2luZ2xlTGluZU1vZGFsKFxyXG4gICAgICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICAgICAgXCJSZXNldCB0ZW1wb3JhcnkgZ3JvdXBzXCIsXHJcbiAgICAgICAgICAgIFwiUHJlZml4IChkZWZhdWx0OiBzZXNzaW9uXylcIixcclxuICAgICAgICAgICAgcmVzb2x2ZVxyXG4gICAgICAgICAgKS5vcGVuKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHAgPSBwcmVmaXggJiYgcHJlZml4LnRyaW0oKS5sZW5ndGggPiAwID8gcHJlZml4LnRyaW0oKSA6IFwic2Vzc2lvbl9cIjtcclxuICAgICAgICBjb25zdCB1c2VycyA9IGF3YWl0IHRoaXMubG9hZFVzZXJzKCk7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgdSBvZiB1c2Vycykge1xyXG4gICAgICAgICAgaWYgKHUubmFtZSA9PT0gXCJBZG1pblwiKSBjb250aW51ZTtcclxuICAgICAgICAgIHUuZ3JvdXBzID0gKHUuZ3JvdXBzID8/IFtdKS5maWx0ZXIoKGdyKSA9PiAhU3RyaW5nKGdyKS5zdGFydHNXaXRoKHApKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZVVzZXJzKHVzZXJzKTtcclxuICAgICAgICB0aGlzLnJlZnJlc2hBbGxNYXJrZG93blZpZXdzKCk7XHJcbiAgICAgICAgbmV3IE5vdGljZShgXHUyNzA1IFJlbW92ZWQgYWxsIGdyb3VwcyBzdGFydGluZyB3aXRoIFwiJHtwfVwiIGZyb20gYWxsIHBsYXllcnNgKTtcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIC0tLSBBZG1pbjogV2hvIGhhcyBncm91cD8gLS0tXHJcbiAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICBpZDogXCJhdXRoZW50aWZpY2F0b3ItYWRtaW4td2hvLWhhcy1ncm91cFwiLFxyXG4gICAgICBuYW1lOiBcIkFkbWluOiBXaG8gaGFzIGdyb3VwP1wiLFxyXG4gICAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGlmICghdGhpcy5pc0FkbWluKCkpIHtcclxuICAgICAgICAgIG5ldyBOb3RpY2UoXCJcdUQ4M0RcdURFQUIgQWRtaW4gb25seS4gUGxlYXNlIGxvZ2luIGFzIEFkbWluLlwiKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGdyb3VwID0gYXdhaXQgbmV3IFByb21pc2U8c3RyaW5nIHwgbnVsbD4oKHJlc29sdmUpID0+IHtcclxuICAgICAgICAgIG5ldyBTaW5nbGVMaW5lTW9kYWwoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICBcIldobyBoYXMgZ3JvdXA/XCIsXHJcbiAgICAgICAgICAgIFwiR3JvdXAgbmFtZSAoZS5nLiBwYXJ0eSlcIixcclxuICAgICAgICAgICAgcmVzb2x2ZVxyXG4gICAgICAgICAgKS5vcGVuKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKCFncm91cCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBjb25zdCBnID0gZ3JvdXAudHJpbSgpO1xyXG4gICAgICAgIGNvbnN0IHVzZXJzID0gYXdhaXQgdGhpcy5sb2FkVXNlcnMoKTtcclxuICAgICAgICBjb25zdCBob2xkZXJzID0gdXNlcnNcclxuICAgICAgICAgIC5maWx0ZXIoKHUpID0+IHUubmFtZSAhPT0gXCJBZG1pblwiKVxyXG4gICAgICAgICAgLmZpbHRlcigodSkgPT4gKHUuZ3JvdXBzID8/IFtdKS5pbmNsdWRlcyhnKSlcclxuICAgICAgICAgIC5tYXAoKHUpID0+IHUubmFtZSk7XHJcblxyXG4gICAgICAgIG5ldyBOb3RpY2UoXHJcbiAgICAgICAgICBob2xkZXJzLmxlbmd0aCA/IGBcdTI3MDUgXCIke2d9XCIgaG9sZGVyczogJHtob2xkZXJzLmpvaW4oXCIsIFwiKX1gIDogYFx1MjEzOVx1RkUwRiBOb2JvZHkgaGFzIFwiJHtnfVwiYFxyXG4gICAgICAgICk7XHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgLy8gLS0tIFJlbmRlcmluZzogZG5kZ2F0ZSBjb2RlYmxvY2sgLS0tXHJcbiAgICB0aGlzLnJlZ2lzdGVyTWFya2Rvd25Db2RlQmxvY2tQcm9jZXNzb3IoXCJkbmRnYXRlXCIsIGFzeW5jIChzb3VyY2UsIGVsLCBjdHgpID0+IHtcclxuICAgICAgY29uc3QgcGFyc2VkID0gcGFyc2VEbmRHYXRlKHNvdXJjZSk7XHJcblxyXG4gICAgICAvLyBBZG1pbiBvdmVycmlkZVxyXG4gICAgICBpZiAodGhpcy5pc0FkbWluKCkpIHtcclxuICAgICAgICBhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlck1hcmtkb3duKHBhcnNlZC5ib2R5LnRyaW0oKSwgZWwsIGN0eC5zb3VyY2VQYXRoLCB0aGlzKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGF1dGhlZCA9IHRoaXMuc3RhdGUuaXNBdXRoZW50aWNhdGVkO1xyXG4gICAgICBjb25zdCBhdXRoT2sgPSBwYXJzZWQucmVxdWlyZUF1dGggPyBhdXRoZWQgOiB0cnVlO1xyXG5cclxuICAgICAgY29uc3QgcmVxdWlyZWQgPSBwYXJzZWQuZ3JvdXBzO1xyXG4gICAgICBjb25zdCB1c2VyR3JvdXBzID0gdGhpcy5zdGF0ZS5jdXJyZW50R3JvdXBzID8/IFtdO1xyXG4gICAgICBjb25zdCBncm91cE9rID1cclxuICAgICAgICByZXF1aXJlZC5sZW5ndGggPiAwICYmIHJlcXVpcmVkLnNvbWUoKGcpID0+IHVzZXJHcm91cHMuaW5jbHVkZXMoZykpO1xyXG5cclxuICAgICAgaWYgKCFhdXRoT2sgfHwgIWdyb3VwT2spIHtcclxuICAgICAgICBlbC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IFwiXHVEODNEXHVERDEyIEFjY2VzcyBkZW5pZWQuXCIgfSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlck1hcmtkb3duKHBhcnNlZC5ib2R5LnRyaW0oKSwgZWwsIGN0eC5zb3VyY2VQYXRoLCB0aGlzKTtcclxuICAgIH0pO1xyXG5cclxuXHJcblxyXG4gICAgLy8gLS0tIFJlbmRlcmluZzogd2hvbGUtbm90ZSBmcm9udG1hdHRlciBnYXRlICsgZnJpZW5kbHkgVUkgLS0tXHJcbiAgICB0aGlzLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKChlbCwgY3R4KSA9PiB7XHJcbiAgICAgIGlmICh0aGlzLmlzQWRtaW4oKSkgcmV0dXJuO1xyXG5cclxuICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChjdHguc291cmNlUGF0aCk7XHJcbiAgICAgIGlmICghZmlsZSkgcmV0dXJuO1xyXG5cclxuICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlIGFzIGFueSk7XHJcbiAgICAgIGNvbnN0IGZtID0gY2FjaGU/LmZyb250bWF0dGVyO1xyXG4gICAgICBpZiAoIWZtKSByZXR1cm47XHJcblxyXG4gICAgICBjb25zdCByZXF1aXJlZEdyb3Vwczogc3RyaW5nW10gPSBBcnJheS5pc0FycmF5KGZtLmRuZF9hY2Nlc3NfZ3JvdXBzKVxyXG4gICAgICAgID8gZm0uZG5kX2FjY2Vzc19ncm91cHNcclxuICAgICAgICA6IFtdO1xyXG4gICAgICBpZiAocmVxdWlyZWRHcm91cHMubGVuZ3RoID09PSAwKSByZXR1cm47XHJcblxyXG4gICAgICBjb25zdCByZXF1aXJlQXV0aDogYm9vbGVhbiA9XHJcbiAgICAgICAgdHlwZW9mIGZtLmRuZF9yZXF1aXJlX2F1dGggPT09IFwiYm9vbGVhblwiID8gZm0uZG5kX3JlcXVpcmVfYXV0aCA6IHRydWU7XHJcblxyXG4gICAgICBjb25zdCBhdXRoZWQgPSB0aGlzLnN0YXRlLmlzQXV0aGVudGljYXRlZDtcclxuICAgICAgY29uc3QgYXV0aE9rID0gcmVxdWlyZUF1dGggPyBhdXRoZWQgOiB0cnVlO1xyXG5cclxuICAgICAgY29uc3QgdXNlckdyb3VwcyA9IHRoaXMuc3RhdGUuY3VycmVudEdyb3VwcyA/PyBbXTtcclxuICAgICAgY29uc3QgZ3JvdXBPayA9IHJlcXVpcmVkR3JvdXBzLnNvbWUoKGcpID0+IHVzZXJHcm91cHMuaW5jbHVkZXMoZykpO1xyXG5cclxuICAgICAgaWYgKGF1dGhPayAmJiBncm91cE9rKSByZXR1cm47XHJcblxyXG4gICAgICBlbC5lbXB0eSgpO1xyXG4gICAgICBjb25zdCBib3ggPSBlbC5jcmVhdGVEaXYoeyBjbHM6IFwiYXV0aGVudGlmaWNhdG9yLWRlbmllZFwiIH0pO1xyXG4gICAgICBib3guY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiXHVEODNEXHVERDEyIEFjY2VzcyBkZW5pZWRcIiB9KTtcclxuXHJcbiAgICAgIGlmICghdGhpcy5zdGF0ZS5jdXJyZW50Q2hhcmFjdGVyKSB7XHJcbiAgICAgICAgYm94LmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IFwiTm8gY2hhcmFjdGVyIHNlbGVjdGVkLlwiIH0pO1xyXG4gICAgICAgIGFkZEFjdGlvbkJ1dHRvbihib3gsIFwiU2VsZWN0IGNoYXJhY3RlclwiLCAoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLmFwcC5jb21tYW5kcy5leGVjdXRlQ29tbWFuZEJ5SWQoXHJcbiAgICAgICAgICAgIFwib2JzaWRpYW5fYWNjb3VudF9tYW5hZ2VyOmF1dGhlbnRpZmljYXRvci1zZWxlY3QtY2hhcmFjdGVyXCJcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIXRoaXMuc3RhdGUuaXNBdXRoZW50aWNhdGVkKSB7XHJcbiAgICAgICAgYm94LmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IFwiWW91IG11c3QgbG9naW4gdG8gYWNjZXNzIHRoaXMgY29udGVudC5cIiB9KTtcclxuICAgICAgICBhZGRBY3Rpb25CdXR0b24oYm94LCBcIkxvZ2luXCIsICgpID0+IHtcclxuICAgICAgICAgIHRoaXMuYXBwLmNvbW1hbmRzLmV4ZWN1dGVDb21tYW5kQnlJZChcclxuICAgICAgICAgICAgXCJvYnNpZGlhbl9hY2NvdW50X21hbmFnZXI6YXV0aGVudGlmaWNhdG9yLWxvZ2luXCJcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGFkZEFjdGlvbkJ1dHRvbihib3gsIFwiT3BlbiBnYXRlZCBub3RlXHUyMDI2XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLmFwcC5jb21tYW5kcy5leGVjdXRlQ29tbWFuZEJ5SWQoXHJcbiAgICAgICAgICBcIm9ic2lkaWFuX2FjY291bnRfbWFuYWdlcjphdXRoZW50aWZpY2F0b3Itb3Blbi1nYXRlZC1ub3RlXCJcclxuICAgICAgICApO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIG9udW5sb2FkKCkgeyB9XHJcblxyXG4gIHByaXZhdGUgcmVuZGVyU3RhdHVzKCkge1xyXG4gICAgaWYgKCF0aGlzLnN0YXR1c0VsKSByZXR1cm47XHJcbiAgICBjb25zdCBjID0gdGhpcy5zdGF0ZS5jdXJyZW50Q2hhcmFjdGVyID8/IFwibm9uZVwiO1xyXG4gICAgY29uc3QgbG9jayA9IHRoaXMuc3RhdGUuaXNBdXRoZW50aWNhdGVkID8gXCJ1bmxvY2tlZFwiIDogXCJsb2NrZWRcIjtcclxuICAgIGNvbnN0IGcgPSB0aGlzLmlzQWRtaW4oKVxyXG4gICAgICA/IFwiQURNSU5cIlxyXG4gICAgICA6IHRoaXMuc3RhdGUuY3VycmVudEdyb3Vwcz8ubGVuZ3RoXHJcbiAgICAgICAgPyB0aGlzLnN0YXRlLmN1cnJlbnRHcm91cHMuam9pbihcIixcIilcclxuICAgICAgICA6IFwiLVwiO1xyXG4gICAgdGhpcy5zdGF0dXNFbC5zZXRUZXh0KGBhdXRoZW50aWZpY2F0b3I6ICR7Y30gKCR7bG9ja30pIFske2d9XWApO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBpc0FkbWluKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuc3RhdGUuY3VycmVudENoYXJhY3RlciA9PT0gXCJBZG1pblwiICYmIHRoaXMuc3RhdGUuaXNBdXRoZW50aWNhdGVkO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSByZWZyZXNoQWxsTWFya2Rvd25WaWV3cygpIHtcclxuICAgIHRoaXMuYXBwLndvcmtzcGFjZS5pdGVyYXRlQWxsTGVhdmVzKChsZWFmKSA9PiB7XHJcbiAgICAgIGNvbnN0IHZpZXc6IGFueSA9IGxlYWYudmlldztcclxuICAgICAgaWYgKCF2aWV3KSByZXR1cm47XHJcbiAgICAgIGlmICh2aWV3LmdldFZpZXdUeXBlPy4oKSA9PT0gXCJtYXJrZG93blwiKSB7XHJcbiAgICAgICAgdmlldy5wcmV2aWV3TW9kZT8ucmVyZW5kZXI/Lih0cnVlKTtcclxuICAgICAgICB2aWV3LmN1cnJlbnRNb2RlPy5yZXJlbmRlcj8uKHRydWUpO1xyXG4gICAgICAgIHZpZXcucmVuZGVyPy4oKTtcclxuICAgICAgICBjb25zdCBmaWxlID0gdmlldy5maWxlO1xyXG4gICAgICAgIGlmIChmaWxlKSB7XHJcbiAgICAgICAgICBsZWFmXHJcbiAgICAgICAgICAgIC5vcGVuRmlsZShmaWxlLCB7IGFjdGl2ZTogZmFsc2UsIHN0YXRlOiBsZWFmLmdldFZpZXdTdGF0ZSgpLnN0YXRlIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaCgoKSA9PiB7IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGVuc3VyZUZvbGRlcihwYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGNvbnN0IGV4aXN0aW5nID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBhdGgpO1xyXG4gICAgaWYgKGV4aXN0aW5nKSByZXR1cm47XHJcbiAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGVGb2xkZXIocGF0aCkuY2F0Y2goKCkgPT4geyB9KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgdXBzZXJ0RmlsZShwYXRoOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc3QgZXhpc3RpbmcgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocGF0aCk7XHJcblxyXG4gICAgaWYgKGV4aXN0aW5nKSB7XHJcbiAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShleGlzdGluZyBhcyBhbnksIGNvbnRlbnQpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc2xhc2ggPSBwYXRoLmxhc3RJbmRleE9mKFwiL1wiKTtcclxuICAgIGlmIChzbGFzaCA+IDApIHtcclxuICAgICAgY29uc3QgZm9sZGVyID0gcGF0aC5zdWJzdHJpbmcoMCwgc2xhc2gpO1xyXG4gICAgICBhd2FpdCB0aGlzLmVuc3VyZUZvbGRlcihmb2xkZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShwYXRoLCBjb250ZW50KS5jYXRjaCgoKSA9PiB7IH0pO1xyXG4gIH1cclxuXHJcblxyXG4gIHByaXZhdGUgYXN5bmMgZW5zdXJlVXNlcnNGaWxlKCk6IFByb21pc2U8VXNlcnNEYj4ge1xyXG4gICAgY29uc3QgZXhpc3RpbmcgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoVVNFUlNfUEFUSCk7XHJcblxyXG4gICAgaWYgKCFleGlzdGluZykge1xyXG4gICAgICBjb25zdCBkYjogVXNlcnNEYiA9IHtcclxuICAgICAgICB1c2VyczogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBuYW1lOiBcIkFkbWluXCIsXHJcbiAgICAgICAgICAgIHNhbHQ6IFwiaW5pdEFkbWluU2FsdFwiLFxyXG4gICAgICAgICAgICBoYXNoOiBcIjZmQURZelQ5OFZXcjk3MGNKMnJEL3NFbXRobFJLOVhxNzFZSHJYWVpNWk09XCIsXHJcbiAgICAgICAgICAgIGdyb3VwczogW1wiYWRtaW5cIiwgXCJkbVwiXSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgXSxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGF3YWl0IHRoaXMudXBzZXJ0RmlsZShVU0VSU19QQVRILCBKU09OLnN0cmluZ2lmeShkYiwgbnVsbCwgMikpO1xyXG4gICAgICByZXR1cm4gZGI7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdHh0ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChleGlzdGluZyBhcyBhbnkpO1xyXG4gICAgcmV0dXJuIEpTT04ucGFyc2UodHh0KSBhcyBVc2Vyc0RiO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBsb2FkVXNlcnMoKTogUHJvbWlzZTxVc2VyRW50cnlbXT4ge1xyXG4gICAgY29uc3QgZGIgPSBhd2FpdCB0aGlzLmVuc3VyZVVzZXJzRmlsZSgpO1xyXG4gICAgcmV0dXJuIGRiLnVzZXJzID8/IFtdO1xyXG4gIH1cclxuXHJcblxyXG4gIHByaXZhdGUgYXN5bmMgc2F2ZVVzZXJzKHVzZXJzOiBVc2VyRW50cnlbXSk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc3QgdHh0ID0gSlNPTi5zdHJpbmdpZnkoeyB1c2VycyB9IGFzIFVzZXJzRGIsIG51bGwsIDIpO1xyXG4gICAgYXdhaXQgdGhpcy51cHNlcnRGaWxlKFVTRVJTX1BBVEgsIHR4dCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlVXNlclJlcG9ydE5vdGUoKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgIGNvbnN0IFJFUE9SVF9QQVRIID0gXCJBZG1pbiBBcmVhL1VzZXJSZXBvcnQubWRcIjtcclxuXHJcbiAgICBjb25zdCB1c2VycyA9IGF3YWl0IHRoaXMubG9hZFVzZXJzKCk7XHJcblxyXG4gICAgY29uc3QgbGluZXM6IHN0cmluZ1tdID0gW107XHJcbiAgICBsaW5lcy5wdXNoKFwiLS0tXCIpO1xyXG4gICAgbGluZXMucHVzaChcImRuZF9hY2Nlc3NfZ3JvdXBzOiBbYWRtaW5dXCIpO1xyXG4gICAgbGluZXMucHVzaChcImRuZF9yZXF1aXJlX2F1dGg6IHRydWVcIik7XHJcbiAgICBsaW5lcy5wdXNoKFwiZ2VuZXJhdGVkOiB0cnVlXCIpO1xyXG4gICAgbGluZXMucHVzaChcIi0tLVwiKTtcclxuICAgIGxpbmVzLnB1c2goXCJcIik7XHJcbiAgICBsaW5lcy5wdXNoKFwiIyBVc2VyIFJlcG9ydFwiKTtcclxuICAgIGxpbmVzLnB1c2goXCJcIik7XHJcbiAgICBsaW5lcy5wdXNoKGBVcGRhdGVkOiAke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKX1gKTtcclxuICAgIGxpbmVzLnB1c2goXCJcIik7XHJcbiAgICBsaW5lcy5wdXNoKFwifCBVc2VyIHwgR3JvdXBzIHxcIik7XHJcbiAgICBsaW5lcy5wdXNoKFwifC0tLXwtLS18XCIpO1xyXG4gICAgZm9yIChjb25zdCB1IG9mIHVzZXJzKSB7XHJcbiAgICAgIGxpbmVzLnB1c2goYHwgJHt1Lm5hbWV9IHwgJHsodS5ncm91cHMgPz8gW10pLmpvaW4oXCIsIFwiKSB8fCBcIi1cIn0gfGApO1xyXG4gICAgfVxyXG4gICAgbGluZXMucHVzaChcIlwiKTtcclxuXHJcbiAgICBhd2FpdCB0aGlzLnVwc2VydEZpbGUoUkVQT1JUX1BBVEgsIGxpbmVzLmpvaW4oXCJcXG5cIikpO1xyXG4gICAgcmV0dXJuIFJFUE9SVF9QQVRIO1xyXG4gIH1cclxuXHJcblxyXG5cclxuICBwcml2YXRlIGFzeW5jIHZlcmlmeVBhc3N3b3JkKFxyXG4gICAgdXNlck5hbWU6IHN0cmluZyxcclxuICAgIHBhc3N3b3JkOiBzdHJpbmdcclxuICApOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICAgIGNvbnN0IHVzZXJzID0gYXdhaXQgdGhpcy5sb2FkVXNlcnMoKTtcclxuICAgIGNvbnN0IHUgPSB1c2Vycy5maW5kKCh4KSA9PiB4Lm5hbWUgPT09IHVzZXJOYW1lKTtcclxuICAgIGlmICghdSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgY29uc3QgY2FuZGlkYXRlID0gc2hhMjU2QmFzZTY0KGAke3Uuc2FsdH06JHtwYXNzd29yZH1gKTtcclxuICAgIHJldHVybiBjYW5kaWRhdGUgPT09IHUuaGFzaDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FuQWNjZXNzRmlsZShmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKHRoaXMuaXNBZG1pbigpKSByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xyXG4gICAgY29uc3QgZm0gPSBjYWNoZT8uZnJvbnRtYXR0ZXI7XHJcbiAgICBpZiAoIWZtKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgY29uc3QgcmVxdWlyZWRHcm91cHM6IHN0cmluZ1tdID0gQXJyYXkuaXNBcnJheShmbS5kbmRfYWNjZXNzX2dyb3VwcylcclxuICAgICAgPyBmbS5kbmRfYWNjZXNzX2dyb3Vwc1xyXG4gICAgICA6IFtdO1xyXG4gICAgaWYgKHJlcXVpcmVkR3JvdXBzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlOyAvLyBnYXRlZC1vcGVuIGxpc3QgaXMgb25seSBmb3IgZ2F0ZWQgbm90ZXNcclxuXHJcbiAgICBjb25zdCByZXF1aXJlQXV0aDogYm9vbGVhbiA9XHJcbiAgICAgIHR5cGVvZiBmbS5kbmRfcmVxdWlyZV9hdXRoID09PSBcImJvb2xlYW5cIiA/IGZtLmRuZF9yZXF1aXJlX2F1dGggOiB0cnVlO1xyXG4gICAgaWYgKHJlcXVpcmVBdXRoICYmICF0aGlzLnN0YXRlLmlzQXV0aGVudGljYXRlZCkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIGNvbnN0IHVzZXJHcm91cHMgPSB0aGlzLnN0YXRlLmN1cnJlbnRHcm91cHMgPz8gW107XHJcbiAgICByZXR1cm4gcmVxdWlyZWRHcm91cHMuc29tZSgoZykgPT4gdXNlckdyb3Vwcy5pbmNsdWRlcyhnKSk7XHJcbiAgfVxyXG59XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tIE1vZGFscyAtLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5jbGFzcyBCdXR0b25Vc2VyUGlja01vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgYXBwOiBBcHAsXHJcbiAgICBwcml2YXRlIHVzZXJzOiBVc2VyRW50cnlbXSxcclxuICAgIHByaXZhdGUgZG9uZTogKHU6IFVzZXJFbnRyeSB8IG51bGwpID0+IHZvaWRcclxuICApIHtcclxuICAgIHN1cGVyKGFwcCk7XHJcbiAgfVxyXG5cclxuICBvbk9wZW4oKSB7XHJcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xyXG4gICAgY29udGVudEVsLmNyZWF0ZUVsKFwiaDNcIiwgeyB0ZXh0OiBcIlNlbGVjdCBjaGFyYWN0ZXJcIiB9KTtcclxuXHJcbiAgICBpZiAoIXRoaXMudXNlcnMubGVuZ3RoKSB7XHJcbiAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBcIk5vIHVzZXJzIGZvdW5kLlwiIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZm9yIChjb25zdCB1IG9mIHRoaXMudXNlcnMpIHtcclxuICAgICAgICBjb25zdCBidG4gPSBjb250ZW50RWwuY3JlYXRlRWwoXCJidXR0b25cIiwgeyB0ZXh0OiB1Lm5hbWUgfSk7XHJcbiAgICAgICAgYnRuLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICAgICAgYnRuLnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XHJcbiAgICAgICAgYnRuLnN0eWxlLm1hcmdpbiA9IFwiMC40cmVtIDBcIjtcclxuICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgIHRoaXMuZG9uZSh1KTtcclxuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNhbmNlbCA9IGNvbnRlbnRFbC5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IFwiQ2FuY2VsXCIgfSk7XHJcbiAgICBjYW5jZWwuc3R5bGUubWFyZ2luVG9wID0gXCIwLjhyZW1cIjtcclxuICAgIGNhbmNlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLmRvbmUobnVsbCk7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgb25DbG9zZSgpIHtcclxuICAgIHRoaXMuY29udGVudEVsLmVtcHR5KCk7XHJcbiAgfVxyXG59XHJcblxyXG5jbGFzcyBQYXNzd29yZE1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gIHByaXZhdGUgdmFsdWUgPSBcIlwiO1xyXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwcml2YXRlIGRvbmU6ICh2OiBzdHJpbmcgfCBudWxsKSA9PiB2b2lkKSB7XHJcbiAgICBzdXBlcihhcHApO1xyXG4gIH1cclxuICBvbk9wZW4oKSB7XHJcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xyXG4gICAgY29udGVudEVsLmNyZWF0ZUVsKFwiaDNcIiwgeyB0ZXh0OiBcIkVudGVyIHBhc3N3b3JkXCIgfSk7XHJcblxyXG4gICAgY29uc3QgaW5wdXQgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJpbnB1dFwiLCB7IHR5cGU6IFwicGFzc3dvcmRcIiB9KTtcclxuICAgIGlucHV0LmZvY3VzKCk7XHJcbiAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4gKHRoaXMudmFsdWUgPSBpbnB1dC52YWx1ZSkpO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgLmFkZEJ1dHRvbigoYikgPT5cclxuICAgICAgICBiXHJcbiAgICAgICAgICAuc2V0QnV0dG9uVGV4dChcIk9LXCIpXHJcbiAgICAgICAgICAuc2V0Q3RhKClcclxuICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5kb25lKHRoaXMudmFsdWUpO1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApXHJcbiAgICAgIC5hZGRCdXR0b24oKGIpID0+XHJcbiAgICAgICAgYi5zZXRCdXR0b25UZXh0KFwiQ2FuY2VsXCIpLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5kb25lKG51bGwpO1xyXG4gICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcbiAgfVxyXG4gIG9uQ2xvc2UoKSB7XHJcbiAgICB0aGlzLmNvbnRlbnRFbC5lbXB0eSgpO1xyXG4gIH1cclxufVxyXG5cclxuY2xhc3MgQ3JlYXRlVXNlck1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gIHByaXZhdGUgbmFtZSA9IFwiXCI7XHJcbiAgcHJpdmF0ZSBwYXNzd29yZCA9IFwiXCI7XHJcbiAgcHJpdmF0ZSBncm91cHMgPSBcIlwiO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGFwcDogQXBwLFxyXG4gICAgcHJpdmF0ZSBkb25lOiAodjogeyBuYW1lOiBzdHJpbmc7IHBhc3N3b3JkOiBzdHJpbmc7IGdyb3Vwczogc3RyaW5nIH0gfCBudWxsKSA9PiB2b2lkXHJcbiAgKSB7XHJcbiAgICBzdXBlcihhcHApO1xyXG4gIH1cclxuXHJcbiAgb25PcGVuKCkge1xyXG4gICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogXCJDcmVhdGUgLyBVcGRhdGUgdXNlclwiIH0pO1xyXG5cclxuICAgIGNvbnN0IG5hbWVJbnB1dCA9IGNvbnRlbnRFbC5jcmVhdGVFbChcImlucHV0XCIsIHtcclxuICAgICAgdHlwZTogXCJ0ZXh0XCIsXHJcbiAgICAgIHBsYWNlaG9sZGVyOiBcIlVzZXIgbmFtZSAoZS5nLiBDYXN0cm8pXCIsXHJcbiAgICB9KTtcclxuICAgIG5hbWVJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4gKHRoaXMubmFtZSA9IG5hbWVJbnB1dC52YWx1ZSkpO1xyXG4gICAgbmFtZUlucHV0LmZvY3VzKCk7XHJcblxyXG4gICAgY29uc3QgcGFzc0lucHV0ID0gY29udGVudEVsLmNyZWF0ZUVsKFwiaW5wdXRcIiwge1xyXG4gICAgICB0eXBlOiBcInBhc3N3b3JkXCIsXHJcbiAgICAgIHBsYWNlaG9sZGVyOiBcIlBhc3N3b3JkXCIsXHJcbiAgICB9KTtcclxuICAgIHBhc3NJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4gKHRoaXMucGFzc3dvcmQgPSBwYXNzSW5wdXQudmFsdWUpKTtcclxuXHJcbiAgICBjb25zdCBncm91cHNJbnB1dCA9IGNvbnRlbnRFbC5jcmVhdGVFbChcImlucHV0XCIsIHtcclxuICAgICAgdHlwZTogXCJ0ZXh0XCIsXHJcbiAgICAgIHBsYWNlaG9sZGVyOiBcIkdyb3VwcyAoY29tbWEgc2VwYXJhdGVkKSwgZS5nLiBwYXJ0eSwgaG91c2VfY2Fubml0aFwiLFxyXG4gICAgfSk7XHJcbiAgICBncm91cHNJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4gKHRoaXMuZ3JvdXBzID0gZ3JvdXBzSW5wdXQudmFsdWUpKTtcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXHJcbiAgICAgIC5hZGRCdXR0b24oKGIpID0+XHJcbiAgICAgICAgYlxyXG4gICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJTYXZlXCIpXHJcbiAgICAgICAgICAuc2V0Q3RhKClcclxuICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5kb25lKHsgbmFtZTogdGhpcy5uYW1lLCBwYXNzd29yZDogdGhpcy5wYXNzd29yZCwgZ3JvdXBzOiB0aGlzLmdyb3VwcyB9KTtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgKVxyXG4gICAgICAuYWRkQnV0dG9uKChiKSA9PlxyXG4gICAgICAgIGIuc2V0QnV0dG9uVGV4dChcIkNhbmNlbFwiKS5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgIHRoaXMuZG9uZShudWxsKTtcclxuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gIH1cclxuXHJcbiAgb25DbG9zZSgpIHtcclxuICAgIHRoaXMuY29udGVudEVsLmVtcHR5KCk7XHJcbiAgfVxyXG59XHJcblxyXG5jbGFzcyBTaW5nbGVMaW5lTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgcHJpdmF0ZSB2YWx1ZSA9IFwiXCI7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBhcHA6IEFwcCxcclxuICAgIHByaXZhdGUgdGl0bGU6IHN0cmluZyxcclxuICAgIHByaXZhdGUgcGxhY2Vob2xkZXI6IHN0cmluZyxcclxuICAgIHByaXZhdGUgZG9uZTogKHY6IHN0cmluZyB8IG51bGwpID0+IHZvaWRcclxuICApIHtcclxuICAgIHN1cGVyKGFwcCk7XHJcbiAgfVxyXG5cclxuICBvbk9wZW4oKSB7XHJcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xyXG4gICAgY29udGVudEVsLmNyZWF0ZUVsKFwiaDNcIiwgeyB0ZXh0OiB0aGlzLnRpdGxlIH0pO1xyXG5cclxuICAgIGNvbnN0IGlucHV0ID0gY29udGVudEVsLmNyZWF0ZUVsKFwiaW5wdXRcIiwge1xyXG4gICAgICB0eXBlOiBcInRleHRcIixcclxuICAgICAgcGxhY2Vob2xkZXI6IHRoaXMucGxhY2Vob2xkZXIsXHJcbiAgICB9KTtcclxuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiAodGhpcy52YWx1ZSA9IGlucHV0LnZhbHVlKSk7XHJcbiAgICBpbnB1dC5mb2N1cygpO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgLmFkZEJ1dHRvbigoYikgPT5cclxuICAgICAgICBiXHJcbiAgICAgICAgICAuc2V0QnV0dG9uVGV4dChcIk9LXCIpXHJcbiAgICAgICAgICAuc2V0Q3RhKClcclxuICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5kb25lKHRoaXMudmFsdWUudHJpbSgpIHx8IG51bGwpO1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApXHJcbiAgICAgIC5hZGRCdXR0b24oKGIpID0+XHJcbiAgICAgICAgYi5zZXRCdXR0b25UZXh0KFwiQ2FuY2VsXCIpLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5kb25lKG51bGwpO1xyXG4gICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcbiAgfVxyXG5cclxuICBvbkNsb3NlKCkge1xyXG4gICAgdGhpcy5jb250ZW50RWwuZW1wdHkoKTtcclxuICB9XHJcbn1cclxuXHJcbmNsYXNzIFVzZXJQaWNrTW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxVc2VyRW50cnk+IHtcclxuICBwcml2YXRlIGhhc1Jlc29sdmVkID0gZmFsc2U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgYXBwOiBBcHAsXHJcbiAgICBwcml2YXRlIHVzZXJzOiBVc2VyRW50cnlbXSxcclxuICAgIHByaXZhdGUgZG9uZTogKHU6IFVzZXJFbnRyeSB8IG51bGwpID0+IHZvaWRcclxuICApIHtcclxuICAgIHN1cGVyKGFwcCk7XHJcbiAgICB0aGlzLnNldFBsYWNlaG9sZGVyKFwiUGljayBhIHVzZXJcdTIwMjZcIik7XHJcbiAgfVxyXG5cclxuICBnZXRJdGVtcygpOiBVc2VyRW50cnlbXSB7XHJcbiAgICByZXR1cm4gdGhpcy51c2VycztcclxuICB9XHJcblxyXG4gIGdldEl0ZW1UZXh0KGl0ZW06IFVzZXJFbnRyeSk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gaXRlbS5uYW1lO1xyXG4gIH1cclxuXHJcbiAgb25DaG9vc2VJdGVtKGl0ZW06IFVzZXJFbnRyeSk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuaGFzUmVzb2x2ZWQpIHJldHVybjtcclxuICAgIHRoaXMuaGFzUmVzb2x2ZWQgPSB0cnVlO1xyXG4gICAgdGhpcy5kb25lKGl0ZW0pO1xyXG4gICAgdGhpcy5jbG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgb25DbG9zZSgpIHtcclxuICAgIHN1cGVyLm9uQ2xvc2UoKTtcclxuICAgIGlmICh0aGlzLmhhc1Jlc29sdmVkKSByZXR1cm47XHJcbiAgICB0aGlzLmhhc1Jlc29sdmVkID0gdHJ1ZTtcclxuICAgIHRoaXMuZG9uZShudWxsKTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5cclxuY2xhc3MgTGl2ZUZpbGVQaWNrTW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxURmlsZT4ge1xyXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwcml2YXRlIHBsdWdpbjogQXV0aGVudGlmaWNhdG9yUGx1Z2luKSB7XHJcbiAgICBzdXBlcihhcHApO1xyXG4gICAgdGhpcy5zZXRQbGFjZWhvbGRlcihcIlR5cGUgdG8gc2VhcmNoIGdhdGVkIG5vdGVzXHUyMDI2XCIpO1xyXG4gIH1cclxuICBnZXRJdGVtcygpOiBURmlsZVtdIHtcclxuICAgIGNvbnN0IGZpbGVzID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcclxuICAgIHJldHVybiBmaWxlcy5maWx0ZXIoKGYpID0+ICh0aGlzLnBsdWdpbiBhcyBhbnkpLmNhbkFjY2Vzc0ZpbGUoZikpO1xyXG4gIH1cclxuICBnZXRJdGVtVGV4dChpdGVtOiBURmlsZSk6IHN0cmluZyB7IHJldHVybiBpdGVtLnBhdGg7IH1cclxuICBhc3luYyBvbkNob29zZUl0ZW0oaXRlbTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGF3YWl0IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZih0cnVlKS5vcGVuRmlsZShpdGVtKTtcclxuICB9XHJcbn1cclxuXHJcbmNsYXNzIFN0YXR1c01lbnVNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcHJpdmF0ZSBwbHVnaW46IEF1dGhlbnRpZmljYXRvclBsdWdpbikge1xyXG4gICAgc3VwZXIoYXBwKTtcclxuICB9XHJcblxyXG4gIG9uT3BlbigpIHtcclxuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgY29udGVudEVsLmVtcHR5KCk7XHJcbiAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiYXV0aGVudGlmaWNhdG9yXCIgfSk7XHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAuc2V0TmFtZShcIlNlbGVjdCBjaGFyYWN0ZXJcIilcclxuICAgICAgLmFkZEJ1dHRvbigoYikgPT5cclxuICAgICAgICBiLnNldEJ1dHRvblRleHQoXCJPcGVuXCIpLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLmNvbW1hbmRzLmV4ZWN1dGVDb21tYW5kQnlJZChcclxuICAgICAgICAgICAgXCJvYnNpZGlhbl9hY2NvdW50X21hbmFnZXI6YXV0aGVudGlmaWNhdG9yLXNlbGVjdC1jaGFyYWN0ZXJcIlxyXG4gICAgICAgICAgKTtcclxuICAgICAgICB9KVxyXG4gICAgICApO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgLnNldE5hbWUoXCJMb2dpbiAocGFzc3dvcmQpXCIpXHJcbiAgICAgIC5hZGRCdXR0b24oKGIpID0+XHJcbiAgICAgICAgYi5zZXRCdXR0b25UZXh0KFwiT3BlblwiKS5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC5jb21tYW5kcy5leGVjdXRlQ29tbWFuZEJ5SWQoXHJcbiAgICAgICAgICAgIFwib2JzaWRpYW5fYWNjb3VudF9tYW5hZ2VyOmF1dGhlbnRpZmljYXRvci1sb2dpblwiXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAuc2V0TmFtZShcIk9wZW4gZ2F0ZWQgbm90ZVx1MjAyNlwiKVxyXG4gICAgICAuYWRkQnV0dG9uKChiKSA9PlxyXG4gICAgICAgIGIuc2V0QnV0dG9uVGV4dChcIk9wZW5cIikub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAuY29tbWFuZHMuZXhlY3V0ZUNvbW1hbmRCeUlkKFxyXG4gICAgICAgICAgICBcIm9ic2lkaWFuX2FjY291bnRfbWFuYWdlcjphdXRoZW50aWZpY2F0b3Itb3Blbi1nYXRlZC1ub3RlXCJcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfSlcclxuICAgICAgKTtcclxuICAgICAgXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAuc2V0TmFtZShcIkxvZ291dFwiKVxyXG4gICAgICAuYWRkQnV0dG9uKChiKSA9PlxyXG4gICAgICAgIGIuc2V0QnV0dG9uVGV4dChcIkRvIGl0XCIpLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLmNvbW1hbmRzLmV4ZWN1dGVDb21tYW5kQnlJZChcclxuICAgICAgICAgICAgXCJvYnNpZGlhbl9hY2NvdW50X21hbmFnZXI6YXV0aGVudGlmaWNhdG9yLWxvZ291dFwiXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcblxyXG5cclxuICAgIC8vIEFkbWluIHNlY3Rpb25cclxuICAgIGlmICgodGhpcy5wbHVnaW4gYXMgYW55KS5pc0FkbWluKCkpIHtcclxuICAgICAgY29udGVudEVsLmNyZWF0ZUVsKFwiaHJcIik7XHJcbiAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgICAuc2V0TmFtZShcIkFkbWluOiBDcmVhdGUvVXBkYXRlIHVzZXJcIilcclxuICAgICAgICAuYWRkQnV0dG9uKChiKSA9PlxyXG4gICAgICAgICAgYi5zZXRCdXR0b25UZXh0KFwiT3BlblwiKS5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAuY29tbWFuZHMuZXhlY3V0ZUNvbW1hbmRCeUlkKFxyXG4gICAgICAgICAgICAgIFwib2JzaWRpYW5fYWNjb3VudF9tYW5hZ2VyOmF1dGhlbnRpZmljYXRvci1hZG1pbi1jcmVhdGUtdXBkYXRlLXVzZXJcIlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG5cclxuICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAgIC5zZXROYW1lKFwiQWRtaW46IFRvZ2dsZSBncm91cCBmb3IgdXNlclwiKVxyXG4gICAgICAgIC5hZGRCdXR0b24oKGIpID0+XHJcbiAgICAgICAgICBiLnNldEJ1dHRvblRleHQoXCJPcGVuXCIpLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC5jb21tYW5kcy5leGVjdXRlQ29tbWFuZEJ5SWQoXHJcbiAgICAgICAgICAgICAgXCJvYnNpZGlhbl9hY2NvdW50X21hbmFnZXI6YXV0aGVudGlmaWNhdG9yLWFkbWluLXRvZ2dsZS1ncm91cFwiXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXHJcbiAgICAgICAgLnNldE5hbWUoXCJBZG1pbjogVG9nZ2xlIGdyb3VwIGZvciBBTEwgcGxheWVyc1wiKVxyXG4gICAgICAgIC5hZGRCdXR0b24oKGIpID0+XHJcbiAgICAgICAgICBiLnNldEJ1dHRvblRleHQoXCJPcGVuXCIpLm9uQ2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC5jb21tYW5kcy5leGVjdXRlQ29tbWFuZEJ5SWQoXHJcbiAgICAgICAgICAgICAgXCJvYnNpZGlhbl9hY2NvdW50X21hbmFnZXI6YXV0aGVudGlmaWNhdG9yLWFkbWluLXRvZ2dsZS1ncm91cC1hbGxcIlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG5cclxuICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAgIC5zZXROYW1lKFwiQWRtaW46IFJlc2V0IHRlbXBvcmFyeSBncm91cHNcIilcclxuICAgICAgICAuYWRkQnV0dG9uKChiKSA9PlxyXG4gICAgICAgICAgYi5zZXRCdXR0b25UZXh0KFwiT3BlblwiKS5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAuY29tbWFuZHMuZXhlY3V0ZUNvbW1hbmRCeUlkKFxyXG4gICAgICAgICAgICAgIFwib2JzaWRpYW5fYWNjb3VudF9tYW5hZ2VyOmF1dGhlbnRpZmljYXRvci1hZG1pbi1yZXNldC10ZW1wLWdyb3Vwc1wiXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXHJcbiAgICAgICAgLnNldE5hbWUoXCJBZG1pbjogV2hvIGhhcyBncm91cD9cIilcclxuICAgICAgICAuYWRkQnV0dG9uKChiKSA9PlxyXG4gICAgICAgICAgYi5zZXRCdXR0b25UZXh0KFwiT3BlblwiKS5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAuY29tbWFuZHMuZXhlY3V0ZUNvbW1hbmRCeUlkKFxyXG4gICAgICAgICAgICAgIFwib2JzaWRpYW5fYWNjb3VudF9tYW5hZ2VyOmF1dGhlbnRpZmljYXRvci1hZG1pbi13aG8taGFzLWdyb3VwXCJcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9uQ2xvc2UoKSB7XHJcbiAgICB0aGlzLmNvbnRlbnRFbC5lbXB0eSgpO1xyXG4gIH1cclxufVxyXG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBUU87QUFDUCxvQkFBd0M7QUFFeEMsSUFBQUEsbUJBQWlDO0FBWWpDLElBQU0sYUFBYTtBQUNuQixJQUFNLGdCQUEyQjtBQUFBLEVBQy9CLGtCQUFrQjtBQUFBLEVBQ2xCLGlCQUFpQjtBQUFBLEVBQ2pCLGVBQWUsQ0FBQztBQUNsQjtBQUVBLFNBQVMsYUFBYSxNQUFzQjtBQUMxQyxhQUFPLDBCQUFXLFFBQVEsRUFBRSxPQUFPLE1BQU0sTUFBTSxFQUFFLE9BQU8sUUFBUTtBQUNsRTtBQUNBLFNBQVMsU0FBUyxRQUFRLElBQVk7QUFDcEMsYUFBTywyQkFBWSxLQUFLLEVBQUUsU0FBUyxRQUFRO0FBQzdDO0FBRUEsU0FBUyxnQkFBZ0IsUUFBcUIsT0FBZSxRQUFvQjtBQUMvRSxRQUFNLE1BQU0sT0FBTyxTQUFTLFVBQVUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUNyRCxNQUFJLE1BQU0sY0FBYztBQUN4QixNQUFJLGlCQUFpQixTQUFTLE1BQU07QUFDdEM7QUFHQSxTQUFTLGFBQWEsUUFBK0I7QUFDbkQsUUFBTSxRQUFRLE9BQU8sTUFBTSxJQUFJO0FBQy9CLE1BQUksU0FBbUIsQ0FBQztBQUN4QixNQUFJLGNBQWM7QUFDbEIsTUFBSSxjQUFjO0FBRWxCLFdBQVMsSUFBSSxHQUFHLElBQUksTUFBTSxRQUFRLEtBQUs7QUFDckMsVUFBTSxPQUFPLE1BQU0sQ0FBQyxFQUFFLEtBQUs7QUFDM0IsUUFBSSxTQUFTLE9BQU87QUFDbEIsb0JBQWMsSUFBSTtBQUNsQjtBQUFBLElBQ0Y7QUFDQSxRQUFJLENBQUMsS0FBTTtBQUVYLFVBQU0sS0FBSyxLQUFLLE1BQU0sc0JBQXNCO0FBQzVDLFFBQUksSUFBSTtBQUNOLGVBQVMsR0FBRyxDQUFDLEVB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
